<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>File Transfer Protocol (FTP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="File Transfer Protocol (FTP)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Postel</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">J. Reynolds</td></tr>
<tr><td class="header">Obsoletes: <a href='http://tools.ietf.org/html/rfc959'>959</a>, <a href='http://tools.ietf.org/html/rfc1639'>1639</a></td><td class="header">ISI</td></tr>
<tr><td class="header">(if&nbsp;approved)</td><td class="header">P. Hethmon</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Hethmon Brothers</td></tr>
<tr><td class="header">Expires: February 7, 2011</td><td class="header">R. Elz</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">University of Melbourne</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Allman</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NASA Lewis Research</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Center/Sterling Software</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Ostermann</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ohio University</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Metz</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">The Inner Net</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Bryan, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 6, 2010</td></tr>
</table></td></tr></table>
<h1><br />File Transfer Protocol (FTP)<br />draft-bryan-ftpbis-00</h1>

<h3>Abstract</h3>

<p>This current edition of the FTP specification is intended to
      correct some minor documentation errors, incorporate and harmonize differences between RFCs, and to improve the
      explanation of some protocol features.

   Note that this specification is compatible with the previous edition.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on February 7, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#sec-1">1.</a>&nbsp;
Introduction<br />
<a href="#sec-2">2.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-2.1">2.1.</a>&nbsp;
History<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-2.2">2.2.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-2.3">2.3.</a>&nbsp;
The FTP Model<br />
<a href="#sec-3">3.</a>&nbsp;
Data Transfer Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.1">3.1.</a>&nbsp;
Data Representation and Storage<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.1.1">3.1.1.</a>&nbsp;
Data Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.1.2">3.1.2.</a>&nbsp;
Data Structures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.2">3.2.</a>&nbsp;
Establishing Data Connections<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.3">3.3.</a>&nbsp;
Data Connection Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.4">3.4.</a>&nbsp;
Transmission Modes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.4.1">3.4.1.</a>&nbsp;
Stream Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.4.2">3.4.2.</a>&nbsp;
Block Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.4.3">3.4.3.</a>&nbsp;
Compressed Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-3.5">3.5.</a>&nbsp;
Error Recovery and Restart<br />
<a href="#sec-4">4.</a>&nbsp;
File Transfer Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.1">4.1.</a>&nbsp;
FTP Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.1.1">4.1.1.</a>&nbsp;
Access Control Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.1.2">4.1.2.</a>&nbsp;
Transfer Parameter Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.1.3">4.1.3.</a>&nbsp;
FTP Service Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.1.4">4.1.4.</a>&nbsp;
Feature Negotiation Mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">4.1.5.</a>&nbsp;
Other Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.2">4.2.</a>&nbsp;
FTP Replies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.2.1">4.2.1.</a>&nbsp;
Reply Code By Function Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-4.2.2">4.2.2.</a>&nbsp;
Numeric Order List of Reply Codes<br />
<a href="#sec-5">5.</a>&nbsp;
Declarative Specifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-5.1">5.1.</a>&nbsp;
Minimum Implementation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-5.2">5.2.</a>&nbsp;
Connections<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-5.3">5.3.</a>&nbsp;
Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-5.3.1">5.3.1.</a>&nbsp;
FTP Commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-5.3.2">5.3.2.</a>&nbsp;
FTP Command Arguments<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-5.4">5.4.</a>&nbsp;
Sequencing of Commands and Replies<br />
<a href="#sec-6">6.</a>&nbsp;
State Diagrams<br />
<a href="#sec-7">7.</a>&nbsp;
Typical FTP Scenario<br />
<a href="#sec-8">8.</a>&nbsp;
Connection Establishment<br />
<a href="#sec-9">9.</a>&nbsp;
IANA Considerations<br />
<a href="#sec-10">10.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec=10.1">10.1.</a>&nbsp;
Privacy and Passwords with Clear Text Protocols<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-10.2">10.2.</a>&nbsp;
Securing FTP with TLS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">10.3.</a>&nbsp;
The Bounce Attack<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">10.3.1.</a>&nbsp;
Protecting Against the Bounce Attack<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">10.4.</a>&nbsp;
Restricted Access<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">10.5.</a>&nbsp;
Protecting Passwords Against Brute Force Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">10.6.</a>&nbsp;
Protecting Usernames<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">10.7.</a>&nbsp;
Port Stealing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">10.8.</a>&nbsp;
Software-Base Security Problems<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">10.9.</a>&nbsp;
Server Capabilities Exposed by FEAT<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#Appendix-A">Appendix&nbsp;A.</a>&nbsp;
Page Structure<br />
<a href="#Appendix-B">Appendix&nbsp;B.</a>&nbsp;
Directory Commands<br />
<a href="#Appendix-C">Appendix&nbsp;C.</a>&nbsp;
RFCs on FTP<br />
<a href="#anchor12">Appendix&nbsp;D.</a>&nbsp;
Acknowledgements and Contributors<br />
<a href="#Appendix-D">Appendix&nbsp;E.</a>&nbsp;
Changelog from RFC 959 and TODO<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="sec-1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
   The objectives of FTP are 1) to promote sharing of files (computer
   programs and/or data), 2) to encourage indirect or implicit (via
   programs) use of remote computers, 3) to shield a user from
   variations in file storage systems among hosts, and 4) to transfer
   data reliably and efficiently.  FTP, though usable directly by a user
   at a terminal, is designed mainly for use by programs.

</p>
<p>
   The attempt in this specification is to satisfy the diverse needs of
   users of maxi-hosts, mini-hosts, personal workstations, and TACs,
   with a simple, and easily implemented protocol design.

</p>
<p>
   This paper assumes knowledge of the Transmission Control Protocol
   (TCP) <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> and the Telnet Protocol <a class='info' href='#RFC0854'>[RFC0854]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;Telnet Protocol Specification,&rdquo; May&nbsp;1983.</span><span>)</span></a>.  These documents are contained
   in the ARPA-Internet protocol handbook <a class='info' href='#IPTW'>[IPTW]<span> (</span><span class='info'>Feinler, E., &ldquo;Internet Protocol Transition Workbook,&rdquo; March&nbsp;1982.</span><span>)</span></a>.

</p>
<a name="sec-2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Overview</h3>

<p>This specification describes conformance of the File Transfer Protocol (FTP).
</p>
<p>
   In this section, the history, the terminology, and the FTP model are
   discussed.  The terms defined in this section are only those that
   have special significance in FTP.  Some of the terminology is very
   specific to the FTP model; some readers may wish to turn to the
   section on the FTP model (<a class='info' href='#sec-2.3'>Section&nbsp;2.3<span> (</span><span class='info'>The FTP Model</span><span>)</span></a>) while reviewing the terminology.

</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
	"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
	document are to be interpreted as described in BCP 14, <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>, as scoped to those conformance targets.
</p>
<p>Syntax required is defined using the Augmented BNF defined in <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="sec-2.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
History</h3>

<p>
      FTP has had a long evolution over the years.  <a class='info' href='#Appendix-C'>Appendix&nbsp;C<span> (</span><span class='info'>RFCs on FTP</span><span>)</span></a> is a
      chronological compilation of Request for Comments documents
      relating to FTP.  These include the first proposed file transfer
      mechanisms in 1971 that were developed for implementation on hosts
      at M.I.T. (RFC 114), plus comments and discussion in RFC 141.

</p>
<p>
      RFC 172 provided a user-level oriented protocol for file transfer
      between host computers (including terminal IMPs).  A revision of
      this as RFC 265, restated FTP for additional review, while RFC 281
      suggested further changes.  The use of a &quot;Set Data Type&quot;
      transaction was proposed in RFC 294 in January 1972.

</p>
<p>
      RFC 354 obsoleted RFCs 264 and 265.  The File Transfer Protocol
      was now defined as a protocol for file transfer between HOSTs on
      the ARPANET, with the primary function of FTP defined as
      transfering files efficiently and reliably among hosts and
      allowing the convenient use of remote file storage capabilities.
      RFC 385 further commented on errors, emphasis points, and
      additions to the protocol, while RFC 414 provided a status report
      on the working server and user FTPs.  RFC 430, issued in 1973,
      (among other RFCs too numerous to mention) presented further
      comments on FTP.  Finally, an &quot;official&quot; FTP document was
      published as RFC 454.

</p>
<p>
      By July 1973, considerable changes from the last versions of FTP
      were made, but the general structure remained the same.  RFC 542
      was published as a new &quot;official&quot; specification to reflect these
      changes.  However, many implementations based on the older
      specification were not updated.

</p>
<p>
      In 1974, RFCs 607 and 614 continued comments on FTP.  RFC 624
      proposed further design changes and minor modifications.  In 1975,
      RFC 686 entitled, &quot;Leaving Well Enough Alone&quot;, discussed the
      differences between all of the early and later versions of FTP.
      RFC 691 presented a minor revision of RFC 686, regarding the
      subject of print files.

</p>
<p>
      Motivated by the transition from the NCP to the TCP as the
      underlying protocol, a phoenix was born out of all of the above
      efforts in RFC 765 as the specification of FTP for use on TCP.

</p>
<p>In 1985, <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> added the following optional commands to FTP:

      CDUP (Change to Parent Directory), SMNT (Structure Mount), STOU
      (Store Unique), RMD (Remove Directory), MKD (Make Directory), PWD
      (Print Directory), and SYST (System).

</p>
<p>
RFC 1123 "Requirements for Internet Hosts -- Application and Support"

</p>
<p>
RFC 1545 "FTP Operation Over Big Address Records (FOOBAR)"

</p>
<p>
RFC 1639 "FTP Operation Over Big Address Records (FOOBAR)"

</p>
<p>
RFC 2389 "Feature negotiation mechanism for the File Transfer Protocol"

</p>
<p>
RFC 2228 "FTP Security Extensions" AUTH, ADAT, PROT, PBSZ, CCC, MIC, CONF, ENC

</p>
<p>
RFC 2428 "FTP Extensions for IPv6 and NATs" EPRT, EPSV

</p>
<p>
RFC 2577 "FTP Security Considerations"

</p>
<p>
RFC 2640 "Internationalization of the File Transfer Protocol" and LANG command.

</p>
<p>
RFC 2773 "Encryption using KEA and SKIPJACK"

</p>
<p>
RFC 3659 "Extensions to FTP" MDTM, SIZE, REST, TVFS, MLST, MLSD

</p>
<p>
RFC 4217 "Securing FTP with TLS"

</p>
<p>
RFC 5797 "FTP Command and Extension Registry"

</p>
<p>
      This current edition of the FTP specification is intended to
      correct some minor documentation errors, synchronize differences between RFCs, and to improve the
      explanation of some protocol features.

</p>
<p>
      This specification is compatible with the previous edition.  A
      program implemented in conformance to the previous specification
      should automatically be in conformance to this specification.

</p>
<a name="sec-2.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Terminology</h3>

<p>
ASCII
</p>
<blockquote class="text">
<p>
         The ASCII character set is as defined in the ARPA-Internet
         Protocol Handbook.  In FTP, ASCII characters are defined to be
         the lower half of an eight-bit code set (i.e., the most
         significant bit is zero).

</p>
</blockquote>

<p>
access controls
</p>
<blockquote class="text">
<p>
         Access controls define users' access privileges to the use of a
         system, and to the files in that system.  Access controls are
         necessary to prevent unauthorized or accidental use of files.
         It is the prerogative of a server-FTP process to invoke access
         controls.

</p>
</blockquote>

<p>
byte size
</p>
<blockquote class="text">
<p>
         There are two byte sizes of interest in FTP:  the logical byte
         size of the file, and the transfer byte size used for the
         transmission of the data.  The transfer byte size is always 8
         bits.  The transfer byte size is not necessarily the byte size
         in which data is to be stored in a system, nor the logical byte
         size for interpretation of the structure of the data.

</p>
</blockquote>

<p>
control connection
</p>
<blockquote class="text">
<p>
         The communication path between the USER-PI and SERVER-PI for
         the exchange of commands and replies.  This connection follows
         the Telnet Protocol.

</p>
</blockquote>

<p>
data connection
</p>
<blockquote class="text">
<p>
         A full duplex connection over which data is transferred, in a
         specified mode and type. The data transferred may be a part of
         a file, an entire file or a number of files.  The path may be
         between a server-DTP and a user-DTP, or between two
         server-DTPs.


</p>
</blockquote>

<p>data port
</p>
<blockquote class="text">
<p>
         The passive data transfer process &quot;listens&quot; on the data port
         for a connection from the active transfer process in order to
         open the data connection.

</p>
</blockquote>

<p>
DTP
</p>
<blockquote class="text">
<p>
         The data transfer process establishes and manages the data
         connection.  The DTP can be passive or active.

</p>
</blockquote>

<p>
End-of-Line
</p>
<blockquote class="text">
<p>
         The end-of-line sequence defines the separation of printing
         lines.  The sequence is Carriage Return, followed by Line Feed.

</p>
</blockquote>

<p>
EOF
</p>
<blockquote class="text">
<p>
         The end-of-file condition that defines the end of a file being
         transferred.

</p>
</blockquote>

<p>EOR
</p>
<blockquote class="text">
<p>
         The end-of-record condition that defines the end of a record
         being transferred.

</p>
</blockquote>

<p>error recovery
</p>
<blockquote class="text">
<p>
         A procedure that allows a user to recover from certain errors
         such as failure of either host system or transfer process.  In
         FTP, error recovery may involve restarting a file transfer at a
         given checkpoint.

</p>
</blockquote>

<p>
FTP commands
</p>
<blockquote class="text">
<p>
         A set of commands that comprise the control information flowing
         from the user-FTP to the server-FTP process.

</p>
</blockquote>

<p>file
</p>
<blockquote class="text">
<p>
         An ordered set of computer data (including programs), of
         arbitrary length, uniquely identified by a pathname.

</p>
</blockquote>

<p>mode
</p>
<blockquote class="text">
<p>
         The mode in which data is to be transferred via the data
         connection.  The mode defines the data format during transfer
         including EOR and EOF.  The transfer modes defined in FTP are
         described in <a class='info' href='#sec-3.4'>Section&nbsp;3.4<span> (</span><span class='info'>Transmission Modes</span><span>)</span></a>.


</p>
</blockquote>

<p>
NVT</p>
<blockquote class="text">
<p>
         The Network Virtual Terminal as defined in the Telnet Protocol.

</p>
</blockquote>

<p>
NVFS
</p>
<blockquote class="text">
<p>
         The Network Virtual File System.  A concept which defines a
         standard network file system with standard commands and
         pathname conventions.

</p>
</blockquote>

<p>page
</p>
<blockquote class="text">
<p>
         A file may be structured as a set of independent parts called
         pages.  FTP supports the transmission of discontinuous files as
         independent indexed pages.

</p>
</blockquote>

<p>pathname
</p>
<blockquote class="text">
<p>
         Pathname is defined to be the character string which must be
         input to a file system by a user in order to identify a file.
         Pathname normally contains device and/or directory names, and
         file name specification.  FTP does not yet specify a standard
         pathname convention.  Each user must follow the file naming
         conventions of the file systems involved in the transfer.

</p>
</blockquote>

<p>PI
</p>
<blockquote class="text">
<p>
         The protocol interpreter.  The user and server sides of the
         protocol have distinct roles implemented in a user-PI and a
         server-PI.


</p>
</blockquote>

<p>record
</p>
<blockquote class="text">
<p>
         A sequential file may be structured as a number of contiguous
         parts called records.  Record structures are supported by FTP
         but a file need not have record structure.

</p>
</blockquote>

<p>reply
</p>
<blockquote class="text">
<p>
         A reply is an acknowledgment (positive or negative) sent from
         server to user via the control connection in response to FTP
         commands.  The general form of a reply is a completion code
         (including error codes) followed by a text string.  The codes
         are for use by programs and the text is usually intended for
         human users.

</p>
</blockquote>

<p>
server-DTP
</p>
<blockquote class="text">
<p>
         The data transfer process, in its normal &quot;active&quot; state,
         establishes the data connection with the &quot;listening&quot; data port.
         It sets up parameters for transfer and storage, and transfers
         data on command from its PI.  The DTP can be placed in a
         &quot;passive&quot; state to listen for, rather than initiate a
         connection on the data port.

</p>
</blockquote>

<p>
server-FTP process
</p>
<blockquote class="text">
<p>
         A process or set of processes which perform the function of
         file transfer in cooperation with a user-FTP process and,
         possibly, another server.  The functions consist of a protocol
         interpreter (PI) and a data transfer process (DTP).


</p>
</blockquote>

<p>
server-PI
</p>
<blockquote class="text">
<p>
         The server protocol interpreter &quot;listens&quot; on Port L for a
         connection from a user-PI and establishes a control
         communication connection.  It receives standard FTP commands
         from the user-PI, sends replies, and governs the server-DTP.

</p>
</blockquote>

<p>
type
</p>
<blockquote class="text">
<p>
         The data representation type used for data transfer and
         storage.  Type implies certain transformations between the time
         of data storage and data transfer.  The representation types
         defined in FTP are described in <a class='info' href='#sec-3.1.1'>Section&nbsp;3.1.1<span> (</span><span class='info'>Data Types</span><span>)</span></a>.

</p>
</blockquote>

<p>
user
</p>
<blockquote class="text">
<p>
         A person or a process on behalf of a person wishing to obtain
         file transfer service.  The human user may interact directly
         with a server-FTP process, but use of a user-FTP process is
         preferred since the protocol design is weighted towards
         automata.

</p>
</blockquote>

<p>
user-DTP
</p>
<blockquote class="text">
<p>  
         The data transfer process &quot;listens&quot; on the data port for a
         connection from a server-FTP process.  If two servers are
         transferring data between them, the user-DTP is inactive.

</p>
</blockquote>

<p>
user-FTP process
</p>
<blockquote class="text">
<p>
         A set of functions including a protocol interpreter, a data
         transfer process and a user interface which together perform
         the function of file transfer in cooperation with one or more
         server-FTP processes.  The user interface allows a local
         language to be used in the command-reply dialogue with the
         user. 

</p>
</blockquote>

<p>
user-PI
</p>
<blockquote class="text">
<p>
         The user protocol interpreter initiates the control connection
         from its port U to the server-FTP process, initiates FTP
         commands, and governs the user-DTP if that process is part of
         the file transfer.

</p>
</blockquote><p>

</p>
<a name="sec-2.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
The FTP Model</h3>

<p>
      With the above definitions in mind, the following model (shown in
      Figure 1) may be diagrammed for an FTP service.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                            -------------
                                            |/---------\|
                                            ||   User  ||    --------
                                            ||Interface|&lt;---&gt;| User |
                                            |\----^----/|    --------
                  ----------                |     |     |
                  |/------\|  FTP Commands  |/----V----\|
                  ||Server|&lt;----------------&gt;|   User  ||
                  ||  PI  ||   FTP Replies  ||    PI   ||
                  |\--^---/|                |\----^----/|
                  |   |    |                |     |     |
      --------    |/--V---\|      Data      |/----V----\|    --------
      | File |&lt;---&gt;|Server|&lt;----------------&gt;|  User   |&lt;---&gt;| File |
      |System|    || DTP  ||   Connection   ||   DTP   ||    |System|
      --------    |\------/|                |\---------/|    --------
                  ----------                -------------

                  Server-FTP                   USER-FTP

      NOTES: 1. The data connection may be used in either direction.
             2. The data connection need not exist all of the time.

                      Figure 1  Model for FTP Use
</pre></div><p>


</p>
<p>
      In the model described in Figure 1, the user-protocol interpreter
      initiates the control connection.  The control connection follows
      the Telnet protocol.  At the initiation of the user, standard FTP
      commands are generated by the user-PI and transmitted to the
      server process via the control connection.  (The user may
      establish a direct control connection to the server-FTP, from a
      TAC terminal for example, and generate standard FTP commands
      independently, bypassing the user-FTP process.) Standard replies
      are sent from the server-PI to the user-PI over the control
      connection in response to the commands.

</p>
<p>
      The FTP commands specify the parameters for the data connection
      (data port, transfer mode, representation type, and structure) and
      the nature of file system operation (store, retrieve, append,
      delete, etc.).  The user-DTP or its designate should &quot;listen&quot; on
      the specified data port, and the server initiate the data
      connection and data transfer in accordance with the specified
      parameters.  It should be noted that the data port need not be in
      the same host that initiates the FTP commands via the control
      connection, but the user or the user-FTP process must ensure a
      &quot;listen&quot; on the specified data port.  It ought to also be noted
      that the data connection may be used for simultaneous sending and
      receiving.

</p>
<p>
      In another situation a user might wish to transfer files between
      two hosts, neither of which is a local host. The user sets up
      control connections to the two servers and then arranges for a
      data connection between them.  In this manner, control information
      is passed to the user-PI but data is transferred between the
      server data transfer processes.  Following is a model of this
      server-server interaction.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                    Control     ------------   Control
                    ----------&gt;| User-FTP |&lt;-----------
                    |          | User-PI  |           |
                    |          |   "C"    |           |
                    V          ------------           V
            --------------                        --------------
            | Server-FTP |   Data Connection      | Server-FTP |
            |    "A"     |&lt;----------------------&gt;|    "B"     |
            -------------- Port (A)      Port (B) --------------


                                 Figure 2
</pre></div><p>


</p>
<p>
      The protocol requires that the control connections be open while
      data transfer is in progress.  It is the responsibility of the
      user to request the closing of the control connections when
      finished using the FTP service, while it is the server who takes
      the action.  The server may abort data transfer if the control
      connections are closed without command.

</p>
<p>
      The Relationship between FTP and Telnet:
</p>
<blockquote class="text">
<p>
         The FTP uses the Telnet protocol on the control connection.
         This can be achieved in two ways: first, the user-PI or the
         server-PI may implement the rules of the Telnet Protocol
         directly in their own procedures; or, second, the user-PI or
         the server-PI may make use of the existing Telnet module in the
         system.

</p>
<p>
         Ease of implementaion, sharing code, and modular programming
         argue for the second approach.  Efficiency and independence
         argue for the first approach.  In practice, FTP relies on very
         little of the Telnet Protocol, so the first approach does not
         necessarily involve a large amount of code.

</p>
</blockquote><p>

</p>
<a name="sec-3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Data Transfer Functions</h3>

<p>
   Files are transferred only via the data connection.  The control
   connection is used for the transfer of commands, which describe the
   functions to be performed, and the replies to these commands (see <a class='info' href='#sec-4.2'>Section&nbsp;4.2<span> (</span><span class='info'>FTP Replies</span><span>)</span></a>).  Several commands are concerned with the
   transfer of data between hosts.  These data transfer commands include
   the MODE command which specify how the bits of the data are to be
   transmitted, and the STRUcture and TYPE commands, which are used to
   define the way in which the data are to be represented.  The
   transmission and representation are basically independent but the
   &quot;Stream&quot; transmission mode is dependent on the file structure
   attribute and if &quot;Compressed&quot; transmission mode is used, the nature
   of the filler byte depends on the representation type.

</p>
<a name="sec-3.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Data Representation and Storage</h3>

<p>
      Data is transferred from a storage device in the sending host to a
      storage device in the receiving host.  Often it is necessary to
      perform certain transformations on the data because data storage
      representations in the two systems are different.  For example,
      NVT-ASCII has different data storage representations in different
      systems.  DEC TOPS-20s's generally store NVT-ASCII as five 7-bit
      ASCII characters, left-justified in a 36-bit word. IBM Mainframe's
      store NVT-ASCII as 8-bit EBCDIC codes.  Multics stores NVT-ASCII
      as four 9-bit characters in a 36-bit word.  It is desirable to
      convert characters into the standard NVT-ASCII representation when
      transmitting text between dissimilar systems.  The sending and
      receiving sites would have to perform the necessary
      transformations between the standard representation and their
      internal representations.

</p>
<p>
      A different problem in representation arises when transmitting
      binary data (not character codes) between host systems with
      different word lengths.  It is not always clear how the sender
      should send data, and the receiver store it.  For example, when
      transmitting 32-bit bytes from a 32-bit word-length system to a
      36-bit word-length system, it may be desirable (for reasons of
      efficiency and usefulness) to store the 32-bit bytes
      right-justified in a 36-bit word in the latter system.  In any
      case, the user should have the option of specifying data
      representation and transformation functions.  It should be noted
      that FTP provides for very limited data type representations.
      Transformations desired beyond this limited capability should be
      performed by the user directly.

</p>
<a name="sec-3.1.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Data Types</h3>

<p>
         Data representations are handled in FTP by a user specifying a
         representation type.  This type may implicitly (as in ASCII or
         EBCDIC) or explicitly (as in Local byte) define a byte size for
         interpretation which is referred to as the &quot;logical byte size.&quot;
         Note that this has nothing to do with the byte size used for
         transmission over the data connection, called the &quot;transfer
         byte size&quot;, and the two should not be confused.  For example,
         NVT-ASCII has a logical byte size of 8 bits.  If the type is
         Local byte, then the TYPE command has an obligatory second
         parameter specifying the logical byte size.  The transfer byte
         size is always 8 bits.

</p>
<a name="sec-3.1.1.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.1"></a><h3>3.1.1.1.&nbsp;
ASCII Type</h3>

<p>
            This is the default type and MUST be accepted by all FTP
            implementations.  It is intended primarily for the transfer
            of text files, except when both hosts would find the EBCDIC
            type more convenient.

</p>
<p>
            The sender converts the data from an internal character
            representation to the standard 8-bit NVT-ASCII
            representation (see <a class='info' href='#RFC0854'>[RFC0854]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;Telnet Protocol Specification,&rdquo; May&nbsp;1983.</span><span>)</span></a>).  The receiver
            will convert the data from the standard form to his own
            internal form.

</p>
<p>
            In accordance with the NVT standard, the &lt;CRLF&gt; sequence
            should be used where necessary to denote the end of a line
            of text.  (See the discussion of file structure at the end
            of the Section on Data Representation and Storage.)

</p>
<p>
            Using the standard NVT-ASCII representation means that data
            must be interpreted as 8-bit bytes.

</p>
<p>
            The Format parameter for ASCII and EBCDIC types is discussed
            below.

</p>
<a name="sec-3.1.1.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.2"></a><h3>3.1.1.2.&nbsp;
EBCDIC Type</h3>

<p>
            This type is intended for efficient transfer between hosts
            which use EBCDIC for their internal character
            representation.

</p>
<p>
            For transmission, the data are represented as 8-bit EBCDIC
            characters.  The character code is the only difference
            between the functional specifications of EBCDIC and ASCII
            types.

</p>
<p>
            End-of-line (as opposed to end-of-record--see the discussion
            of structure) will probably be rarely used with EBCDIC type
            for purposes of denoting structure, but where it is
            necessary the &lt;NL&gt; character should be used.

</p>
<a name="sec-3.1.1.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.3"></a><h3>3.1.1.3.&nbsp;
Image Type</h3>

<p>
            The data are sent as contiguous bits which, for transfer,
            are packed into the 8-bit transfer bytes.  The receiving
            site must store the data as contiguous bits.  The structure
            of the storage system might necessitate the padding of the
            file (or of each record, for a record-structured file) to
            some convenient boundary (byte, word or block).  This
            padding, which must be all zeros, may occur only at the end
            of the file (or at the end of each record) and there must be
            a way of identifying the padding bits so that they may be
            stripped off if the file is retrieved.  The padding
            transformation should be well publicized to enable a user to
            process a file at the storage site.

</p>
<p>
            Image type is intended for the efficient storage and
            retrieval of files and for the transfer of binary data.  It
            is recommended that this type be accepted by all FTP
            implementations.

</p>
<a name="sec-3.1.1.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.4"></a><h3>3.1.1.4.&nbsp;
Local Type</h3>

<p>
            The data is transferred in logical bytes of the size
            specified by the obligatory second parameter, Byte size.
            The value of Byte size must be a decimal integer; there is
            no default value.  The logical byte size is not necessarily
            the same as the transfer byte size.  If there is a
            difference in byte sizes, then the logical bytes should be
            packed contiguously, disregarding transfer byte boundaries
            and with any necessary padding at the end.

</p>
<p>


</p>
<p>
            When the data reaches the receiving host, it will be
            transformed in a manner dependent on the logical byte size
            and the particular host.  This transformation must be
            invertible (i.e., an identical file can be retrieved if the
            same parameters are used) and should be well publicized by
            the FTP implementors.

</p>
<p>
            For example, a user sending 36-bit floating-point numbers to
            a host with a 32-bit word could send that data as Local byte
            with a logical byte size of 36.  The receiving host would
            then be expected to store the logical bytes so that they
            could be easily manipulated; in this example putting the
            36-bit logical bytes into 64-bit double words should
            suffice.

</p>
<p>
            In another example, a pair of hosts with a 36-bit word size
            may send data to one another in words by using TYPE L 36.
            The data would be sent in the 8-bit transmission bytes
            packed so that 9 transmission bytes carried two host words.

</p>
<a name="sec-3.1.1.5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.5"></a><h3>3.1.1.5.&nbsp;
Format Control</h3>

<p>
            The types ASCII and EBCDIC also take a second (optional)
            parameter; this is to indicate what kind of vertical format
            control, if any, is associated with a file.  The following
            data representation types are defined in FTP:

</p>
<p>
            A character file may be transferred to a host for one of
            three purposes: for printing, for storage and later
            retrieval, or for processing.  If a file is sent for
            printing, the receiving host must know how the vertical
            format control is represented.  In the second case, it must
            be possible to store a file at a host and then retrieve it
            later in exactly the same form.  Finally, it should be
            possible to move a file from one host to another and process
            the file at the second host without undue trouble.  A single
            ASCII or EBCDIC format does not satisfy all these
            conditions.  Therefore, these types have a second parameter
            specifying one of the following three formats:

</p>
<a name="sec-3.1.1.5.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.5.1"></a><h3>3.1.1.5.1.&nbsp;
Non Print</h3>

<p>
               This is the default format to be used if the second
               (format) parameter is omitted.  Non-print format MUST be
               accepted by all FTP implementations.

</p>
<p>


</p>
<p>
               The file need contain no vertical format information.  If
               it is passed to a printer process, this process may
               assume standard values for spacing and margins.

</p>
<p>
               Normally, this format will be used with files destined
               for processing or just storage.

</p>
<a name="sec-3.1.1.5.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.5.2"></a><h3>3.1.1.5.2.&nbsp;
Telnet Format Controls</h3>

<p>
               The file contains ASCII/EBCDIC vertical format controls
               (i.e., &lt;CR&gt;, &lt;LF&gt;, &lt;NL&gt;, &lt;VT&gt;, &lt;FF&gt;) which the printer
               process will interpret appropriately.  &lt;CRLF&gt;, in exactly
               this sequence, also denotes end-of-line.

</p>
<a name="sec-3.1.1.5.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.5.3"></a><h3>3.1.1.5.3.&nbsp;
Carriage Control (ASA)</h3>

<p>
               The file contains ASA (FORTRAN) vertical format control
               characters.  (See RFC 740 Appendix C; and Communications
               of the ACM, Vol. 7, No. 10, p. 606, October 1964.)  In a
               line or a record formatted according to the ASA Standard,
               the first character is not to be printed.  Instead, it
               should be used to determine the vertical movement of the
               paper which should take place before the rest of the
               record is printed.

</p>
<p>
               The ASA Standard specifies the following control
               characters:
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                  Character     Vertical Spacing

                  blank         Move paper up one line
                  0             Move paper up two lines
                  1             Move paper to top of next page
                  +             No movement, i.e., overprint
</pre></div><p>



</p>
<p>
               Clearly there must be some way for a printer process to
               distinguish the end of the structural entity.  If a file
               has record structure (see below) this is no problem;
               records will be explicitly marked during transfer and
               storage.  If the file has no record structure, the &lt;CRLF&gt;
               end-of-line sequence is used to separate printing lines,
               but these format effectors are overridden by the ASA
               controls.

</p>
<a name="sec-3.1.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Data Structures</h3>

<p>
         In addition to different representation types, FTP allows the
         structure of a file to be specified.  Three file structures are
         defined in FTP:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

         file-structure,     where there is no internal structure and
                             the file is considered to be a
                             continuous sequence of data bytes,

         record-structure,   where the file is made up of sequential
                             records,

         and page-structure, where the file is made up of independent
                             indexed pages.
</pre></div><p>



</p>
<p>
         File-structure is the default to be assumed if the STRUcture
         command has not been used but both file and record structures
         must be accepted for &quot;text&quot; files (i.e., files with TYPE ASCII
         or EBCDIC) by all FTP implementations.  The structure of a file
         will affect both the transfer mode of a file (see <a class='info' href='#sec-3.4'>Section&nbsp;3.4<span> (</span><span class='info'>Transmission Modes</span><span>)</span></a>) and the interpretation and storage of
         the file.

</p>
<p>
         The &quot;natural&quot; structure of a file will depend on which host
         stores the file.  A source-code file will usually be stored on
         an IBM Mainframe in fixed length records but on a DEC TOPS-20
         as a stream of characters partitioned into lines, for example
         by &lt;CRLF&gt;.  If the transfer of files between such disparate
         sites is to be useful, there must be some way for one site to
         recognize the other's assumptions about the file.

</p>
<p>
         With some sites being naturally file-oriented and others
         naturally record-oriented there may be problems if a file with
         one structure is sent to a host oriented to the other.  If a
         text file is sent with record-structure to a host which is file
         oriented, then that host should apply an internal
         transformation to the file based on the record structure.
         Obviously, this transformation should be useful, but it must
         also be invertible so that an identical file may be retrieved
         using record structure.

</p>
<p>
         In the case of a file being sent with file-structure to a
         record-oriented host, there exists the question of what
         criteria the host should use to divide the file into records
         which can be processed locally.  If this division is necessary,
         the FTP implementation should use the end-of-line sequence,
         &lt;CRLF&gt; for ASCII, or &lt;NL&gt; for EBCDIC text files, as the
         delimiter.  If an FTP implementation adopts this technique, it
         must be prepared to reverse the transformation if the file is
         retrieved with file-structure.

</p>
<a name="sec-3.1.2.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.1"></a><h3>3.1.2.1.&nbsp;
File Structure</h3>

<p>
            File structure is the default to be assumed if the STRUcture
            command has not been used.

</p>
<p>
            In file-structure there is no internal structure and the
            file is considered to be a continuous sequence of data
            bytes.

</p>
<a name="sec-3.1.2.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.2"></a><h3>3.1.2.2.&nbsp;
Record Structure</h3>

<p>
            Record structures must be accepted for &quot;text&quot; files (i.e.,
            files with TYPE ASCII or EBCDIC) by all FTP implementations.

</p>
<p>
            In record-structure the file is made up of sequential
            records.

</p>
<a name="sec-3.1.2.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.3"></a><h3>3.1.2.3.&nbsp;
Page Structure</h3>

<p>
            To transmit files that are discontinuous, FTP defines a page
            structure.  Files of this type are sometimes known as
            &quot;random access files&quot; or even as &quot;holey files&quot;.  In these
            files there is sometimes other information associated with
            the file as a whole (e.g., a file descriptor), or with a
            section of the file (e.g., page access controls), or both.
            In FTP, the sections of the file are called pages.

</p>
<p>
            To provide for various page sizes and associated
            information, each page is sent with a page header.  The page
            header has the following defined fields:

</p>
<p>
               Header Length

</p>
<p>
                  The number of logical bytes in the page header
                  including this byte.  The minimum header length is 4.

</p>
<p>
               Page Index

</p>
<p>
                  The logical page number of this section of the file.
                  This is not the transmission sequence number of this
                  page, but the index used to identify this page of the
                  file.

</p>
<p>
               Data Length

</p>
<p>
                  The number of logical bytes in the page data.  The
                  minimum data length is 0.

</p>
<p>
               Page Type

</p>
<p>
                  The type of page this is.  The following page types
                  are defined:

</p>
<p>
                     0 = Last Page

</p>
<p>
                        This is used to indicate the end of a paged
                        structured transmission.  The header length must
                        be 4, and the data length must be 0.

</p>
<p>
                     1 = Simple Page

</p>
<p>
                        This is the normal type for simple paged files
                        with no page level associated control
                        information.  The header length must be 4.

</p>
<p>
                     2 = Descriptor Page

</p>
<p>
                        This type is used to transmit the descriptive
                        information for the file as a whole.

</p>
<p>
                     3 = Access Controlled Page

</p>
<p>
                        This type includes an additional header field
                        for paged files with page level access control
                        information.  The header length must be 5.

</p>
<p>
               Optional Fields

</p>
<p>
                  Further header fields may be used to supply per page
                  control information, for example, per page access
                  control.

</p>
<p>
            All fields are one logical byte in length.  The logical byte
            size is specified by the TYPE command.  See <a class='info' href='#Appendix-A'>Appendix&nbsp;A<span> (</span><span class='info'>Page Structure</span><span>)</span></a> for
            further details and a specific case at the page structure.

</p>
<p>
      A note of caution about parameters:  a file must be stored and
      retrieved with the same parameters if the retrieved version is to
      be identical to the version originally transmitted.  Conversely,
      FTP implementations must return a file identical to the original
      if the parameters used to store and retrieve a file are the same.

</p>
<a name="sec-3.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Establishing Data Connections</h3>

<p>
      The mechanics of transferring data consists of setting up the data
      connection to the appropriate ports and choosing the parameters
      for transfer.  Both the user and the server-DTPs have a default
      data port.  The user-process default data port is the same as the
      control connection port (i.e., U).  The server-process default
      data port is the port adjacent to the control connection port
      (i.e., L-1).

</p>
<p>
      The transfer byte size is 8-bit bytes.  This byte size is relevant
      only for the actual transfer of the data; it has no bearing on
      representation of the data within a host's file system.

</p>
<p>
      The passive data transfer process (this may be a user-DTP or a
      second server-DTP) shall &quot;listen&quot; on the data port prior to
      sending a transfer request command.  The FTP request command
      determines the direction of the data transfer.  The server, upon
      receiving the transfer request, will initiate the data connection
      to the port.  When the connection is established, the data
      transfer begins between DTP's, and the server-PI sends a
      confirming reply to the user-PI.

</p>
<p>
      Every FTP implementation MUST support the use of the default data
      ports, and only the USER-PI can initiate a change to non-default
      ports.

</p>
<p>
      It is possible for the user to specify an alternate data port by
      use of the PORT command.  The user may want a file dumped on a TAC
      line printer or retrieved from a third party host.  In the latter
      case, the user-PI sets up control connections with both
      server-PI's.  One server is then told (by an FTP command) to
      &quot;listen&quot; for a connection which the other will initiate.  The
      user-PI sends one server-PI a PORT command indicating the data
      port of the other.  Finally, both are sent the appropriate
      transfer commands.  The exact sequence of commands and replies
      sent between the user-controller and the servers is defined in <a class='info' href='#sec-4.2'>Section&nbsp;4.2<span> (</span><span class='info'>FTP Replies</span><span>)</span></a>

</p>
<p>
      In general, it is the server's responsibility to maintain the data
      connection--to initiate it and to close it.  The exception to this
      is when the user-DTP is sending the data in a transfer mode that
      requires the connection to be closed to indicate EOF.  The server
      MUST close the data connection under the following conditions:
</p>
<blockquote class="text">
<p>
         1. The server has completed sending data in a transfer mode
            that requires a close to indicate EOF.

</p>
<p>
         2. The server receives an ABORT command from the user.

</p>
<p>
         3. The port specification is changed by a command from the
            user.

</p>
<p>
         4. The control connection is closed legally or otherwise.

</p>
<p>
         5. An irrecoverable error condition occurs.

</p>
</blockquote><p>

</p>
<p>
      Otherwise the close is a server option, the exercise of which the
      server must indicate to the user-process by either a 250 or 226
      reply only.

</p>
<a name="sec-3.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Data Connection Management</h3>

<p>
      Default Data Connection Ports:  All FTP implementations MUST
      support use of the default data connection ports, and only the
      User-PI may initiate the use of non-default ports.

</p>
<p>
      Negotiating Non-Default Data Ports:   The User-PI MAY specify a
      non-default user side data port with the PORT command.  The
      User-PI MAY request the server side to identify a non-default
      server side data port with the PASV command.  Since a connection
      is defined by the pair of addresses, either of these actions is
      enough to get a different data connection, still it is permitted
      to do both commands to use new ports on both ends of the data
      connection.

</p>
<p>
      Reuse of the Data Connection:  When using the stream mode of data
      transfer the end of the file MUST be indicated by closing the
      connection.  This causes a problem if multiple files are to be
      transfered in the session, due to need for TCP to hold the
      connection record for a time out period to guarantee the reliable
      communication.  Thus the connection can not be reopened at once.

</p>
<p>
         There are two solutions to this problem.  The first is to
         negotiate a non-default port.  The second is to use another
         transfer mode.

</p>
<p>
         A comment on transfer modes.  The stream transfer mode is
         inherently unreliable, since one can not determine if the
         connection closed prematurely or not.  The other transfer modes
         (Block, Compressed) do not close the connection to indicate the
         end of file.  They have enough FTP encoding that the data
         connection can be parsed to determine the end of the file.
         Thus using these modes one can leave the data connection open
         for multiple file transfers.

</p>
<a name="sec-3.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Transmission Modes</h3>

<p>
      The next consideration in transferring data is choosing the
      appropriate transmission mode.  There are three modes: one which
      formats the data and allows for restart procedures; one which also
      compresses the data for efficient transfer; and one which passes
      the data with little or no processing.  In this last case the mode
      interacts with the structure attribute to determine the type of
      processing.  In the compressed mode, the representation type
      determines the filler byte.

</p>
<p>
      All data transfers MUST be completed with an end-of-file (EOF)
      which MAY be explicitly stated or implied by the closing of the
      data connection.  For files with record structure, all the
      end-of-record markers (EOR) are explicit, including the final one.
      For files transmitted in page structure a &quot;last-page&quot; page type is
      used.

</p>
<p>
      NOTE:  In the rest of this section, byte means &quot;transfer byte&quot;
      except where explicitly stated otherwise.

</p>
<p>
      For the purpose of standardized transfer, the sending host will
      translate its internal end of line or end of record denotation
      into the representation prescribed by the transfer mode and file
      structure, and the receiving host will perform the inverse
      translation to its internal denotation.  An IBM Mainframe record
      count field may not be recognized at another host, so the
      end-of-record information may be transferred as a two byte control
      code in Stream mode or as a flagged bit in a Block or Compressed
      mode descriptor.  End-of-line in an ASCII or EBCDIC file with no
      record structure should be indicated by &lt;CRLF&gt; or &lt;NL&gt;,
      respectively.  Since these transformations imply extra work for
      some systems, identical systems transferring non-record structured
      text files might wish to use a binary representation and stream
      mode for the transfer.

</p>
<p>
      The following transmission modes are defined in FTP:

</p>
<a name="sec-3.4.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Stream Mode</h3>

<p>
         The data is transmitted as a stream of bytes.  There is no
         restriction on the representation type used; record structures
         are allowed.

</p>
<p>
         In a record structured file EOR and EOF will each be indicated
         by a two-byte control code.  The first byte of the control code
         will be all ones, the escape character.  The second byte will
         have the low order bit on and zeros elsewhere for EOR and the
         second low order bit on for EOF; that is, the byte will have
         value 1 for EOR and value 2 for EOF.  EOR and EOF MAY be
         indicated together on the last byte transmitted by turning both
         low order bits on (i.e., the value 3).  If a byte of all ones
         was intended to be sent as data, it should be repeated in the
         second byte of the control code.

</p>
<p>
         If the structure is a file structure, the EOF is indicated by
         the sending host closing the data connection and all bytes are
         data bytes.

</p>
<a name="sec-3.4.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Block Mode</h3>

<p>
         The file is transmitted as a series of data blocks preceded by
         one or more header bytes.  The header bytes contain a count
         field, and descriptor code.  The count field indicates the
         total length of the data block in bytes, thus marking the
         beginning of the next data block (there are no filler bits).
         The descriptor code defines:  last block in the file (EOF) last
         block in the record (EOR), restart marker (see <a class='info' href='#sec-3.5'>Section&nbsp;3.5<span> (</span><span class='info'>Error Recovery and Restart</span><span>)</span></a>) or suspect data (i.e., the data
         being transferred is suspected of errors and is not reliable).
         This last code is NOT intended for error control within FTP.
         It is motivated by the desire of sites exchanging certain types
         of data (e.g., seismic or weather data) to send and receive all
         the data despite local errors (such as &quot;magnetic tape read
         errors&quot;), but to indicate in the transmission that certain
         portions are suspect).  Record structures are allowed in this
         mode, and any representation type MAY be used.

</p>
<p>
         The header consists of the three bytes.  Of the 24 bits of
         header information, the 16 low order bits shall represent byte
         count, and the 8 high order bits shall represent descriptor
         codes as shown below.

</p>
<p>


</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

         Block Header

            +----------------+----------------+----------------+
            | Descriptor     |    Byte Count                   |
            |         8 bits |                      16 bits    |
            +----------------+----------------+----------------+
</pre></div><p>


            

</p>
<p>
         The descriptor codes are indicated by bit flags in the
         descriptor byte.  Four codes have been assigned, where each
         code number is the decimal value of the corresponding bit in
         the byte.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            Code     Meaning

             128     End of data block is EOR
              64     End of data block is EOF
              32     Suspected errors in data block
              16     Data block is a restart marker
</pre></div><p>



</p>
<p>
         With this encoding, more than one descriptor coded condition
         may exist for a particular block.  As many bits as necessary
         may be flagged.

</p>
<p>
         The restart marker is embedded in the data stream as an
         integral number of 8-bit bytes representing printable
         characters in the language being used over the control
         connection (e.g., default--NVT-ASCII).  &lt;SP&gt; (Space, in the
         appropriate language) MUST NOT be used WITHIN a restart marker.

</p>
<p>
         For example, to transmit a six-character marker, the following
         would be sent:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            +--------+--------+--------+
            |Descrptr|  Byte count     |
            |code= 16|             = 6 |
            +--------+--------+--------+

            +--------+--------+--------+
            | Marker | Marker | Marker |
            | 8 bits | 8 bits | 8 bits |
            +--------+--------+--------+

            +--------+--------+--------+
            | Marker | Marker | Marker |
            | 8 bits | 8 bits | 8 bits |
            +--------+--------+--------+

</pre></div><p>



</p>
<p>


</p>
<a name="sec-3.4.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3"></a><h3>3.4.3.&nbsp;
Compressed Mode</h3>

<p>
         There are three kinds of information to be sent:  regular data,
         sent in a byte string; compressed data, consisting of
         replications or filler; and control information, sent in a
         two-byte escape sequence.  If n&gt;0 bytes (up to 127) of regular
         data are sent, these n bytes are preceded by a byte with the
         left-most bit set to 0 and the right-most 7 bits containing the
         number n.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

         Byte string:

             1       7                8                     8
            +-+-+-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+
            |0|       n     | |    d(1)       | ... |      d(n)     |
            +-+-+-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+
                                          ^             ^
                                          |---n bytes---|
                                              of data
</pre></div><p>



</p>
<p>
            String of n data bytes d(1),..., d(n)
            Count n must be positive.

</p>
<p>
         To compress a string of n replications of the data byte d, the
         following 2 bytes are sent:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

         Replicated Byte:

              2       6               8
            +-+-+-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+
            |1 0|     n     | |       d       |
            +-+-+-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+
</pre></div><p>


</p>
<p>
         A string of n filler bytes can be compressed into a single
         byte, where the filler byte varies with the representation
         type.  If the type is ASCII or EBCDIC the filler byte is &lt;SP&gt;
         (Space, ASCII code 32, EBCDIC code 64).  If the type is Image
         or Local byte the filler is a zero byte.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         Filler String:

              2       6
            +-+-+-+-+-+-+-+-+
            |1 1|     n     |
            +-+-+-+-+-+-+-+-+
</pre></div><p>


</p>
<p>
         The escape sequence is a double byte, the first of which is the
         escape byte (all zeros) and the second of which contains
         descriptor codes as defined in Block mode.  The descriptor
         codes have the same meaning as in Block mode and apply to the
         succeeding string of bytes.

</p>
<p>
         Compressed mode is useful for obtaining increased bandwidth on
         very large network transmissions at a little extra CPU cost.
         It can be most effectively used to reduce the size of printer
         files such as those generated by RJE hosts.

</p>
<a name="sec-3.5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Error Recovery and Restart</h3>

<p>
      There is no provision for detecting bits lost or scrambled in data
      transfer; this level of error control is handled by the TCP.
      However, a restart procedure is provided to protect users from
      gross system failures (including failures of a host, an
      FTP-process, or the underlying network).

</p>
<p>
      The restart procedure is defined only for the block and compressed
      modes of data transfer.  It requires the sender of data to insert
      a special marker code in the data stream with some marker
      information.  The marker information has meaning only to the
      sender, but MUST consist of printable characters in the default or
      negotiated language of the control connection (ASCII or EBCDIC).
      The marker could represent a bit-count, a record-count, or any
      other information by which a system may identify a data
      checkpoint.  The receiver of data, if it implements the restart
      procedure, would then mark the corresponding position of this
      marker in the receiving system, and return this information to the
      user.

</p>
<p>
      In the event of a system failure, the user can restart the data
      transfer by identifying the marker point with the FTP restart
      procedure.  The following example illustrates the use of the
      restart procedure.

</p>
<p>
      The sender of the data inserts an appropriate marker block in the
      data stream at a convenient point.  The receiving host marks the
      corresponding data point in its file system and conveys the last
      known sender and receiver marker information to the user, either
      directly or over the control connection in a 110 reply (depending
      on who is the sender).  In the event of a system failure, the user
      or controller process restarts the server at the last server
      marker by sending a restart command with server's marker code as
      its argument.  The restart command is transmitted over the control
      connection and is immediately followed by the command (such as
      RETR, STOR or LIST) which was being executed when the system
      failure occurred.

</p>
<a name="sec-4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
File Transfer Functions</h3>

<p>
   The communication channel from the user-PI to the server-PI is
   established as a TCP connection from the user to the standard server
   port.  The user protocol interpreter is responsible for sending FTP
   commands and interpreting the replies received; the server-PI
   interprets commands, sends replies and directs its DTP to set up the
   data connection and transfer the data.  If the second party to the
   data transfer (the passive transfer process) is the user-DTP, then it
   is governed through the internal protocol of the user-FTP host; if it
   is a second server-DTP, then it is governed by its PI on command from
   the user-PI.  The FTP replies are discussed in the next section.  In
   the description of a few of the commands in this section, it is
   helpful to be explicit about the possible replies.

</p>
<a name="sec-4.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
FTP Commands</h3>

<p>The IANA "FTP Commands and Extensions" Registry created by <a class='info' href='#RFC5797'>[RFC5797]<span> (</span><span class='info'>Klensin, J. and A. Hoenes, &ldquo;FTP Command and Extension Registry,&rdquo; March&nbsp;2010.</span><span>)</span></a> available at http://www.iana.org/assignments/ftp-commands-extensions/ftp-commands-extensions.xhtml contains a comprehensive list of FTP commands and extensions, along with references and more information.
</p>
<a name="sec-4.1.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Access Control Commands</h3>

<p>
         The following commands specify access control identifiers
         (command codes are shown in parentheses).

</p>
<p>
USER NAME (USER)
</p>
<blockquote class="text">
<p>
            The argument field is a Telnet string identifying the user.
            The user identification is that which is required by the
            server for access to its file system.  This command will
            normally be the first command transmitted by the user after
            the control connections are made (some servers MAY require
            this).  Additional identification information in the form of
            a password and/or an account command MAY also be required by
            some servers.  Servers MAY allow a new USER command to be
            entered at any point in order to change the access control
            and/or accounting information.  This has the effect of
            flushing any user, password, and account information already
            supplied and beginning the login sequence again.  All
            transfer parameters are unchanged and any file transfer in
            progress is completed under the old access control
            parameters.

</p>
</blockquote>

<p>
PASSWORD (PASS)
</p>
<blockquote class="text">
<p>
            The argument field is a Telnet string specifying the user's
            password.  This command MUST be immediately preceded by the
            user name command, and, for some sites, completes the user's
            identification for access control.  Since password
            information is quite sensitive, it is desirable in general
            to &quot;mask&quot; it or suppress typeout.  It appears that the
            server has no foolproof way to achieve this.  It is
            therefore the responsibility of the user-FTP process to hide
            the sensitive password information.

</p>
</blockquote>

<p>
         ACCOUNT (ACCT)
</p>
<blockquote class="text">
<p>
            The argument field is a Telnet string identifying the user's
            account.  The command is not necessarily related to the USER
            command, as some sites may require an account for login and
            others only for specific access, such as storing files.  In
            the latter case the command may arrive at any time.

</p>
<p>
            There are reply codes to differentiate these cases for the
            automation: when account information is required for login,
            the response to a successful PASSword command is reply code
            332.  On the other hand, if account information is NOT
            required for login, the reply to a successful PASSword
            command is 230; and if the account information is needed for
            a command issued later in the dialogue, the server should
            return a 332 or 532 reply depending on whether it stores
            (pending receipt of the ACCounT command) or discards the
            command, respectively.

</p>
</blockquote>

<p>
         CHANGE WORKING DIRECTORY (CWD)
</p>
<blockquote class="text">
<p>
            This command allows the user to work with a different
            directory or dataset for file storage or retrieval without
            altering his login or accounting information.  Transfer
            parameters are similarly unchanged.  The argument is a
            pathname specifying a directory or other system dependent
            file group designator.

</p>
</blockquote>

<p>
         CHANGE TO PARENT DIRECTORY (CDUP)
</p>
<blockquote class="text">
<p>
            This command is a special case of CWD, and is included to
            simplify the implementation of programs for transferring
            directory trees between operating systems having different
            syntaxes for naming the parent directory.  The reply codes
            shall be identical to the reply codes of CWD.  See
            <a class='info' href='#Appendix-B'>Appendix&nbsp;B<span> (</span><span class='info'>Directory Commands</span><span>)</span></a> for further details.

</p>
</blockquote>

<p>
         STRUCTURE MOUNT (SMNT)
</p>
<blockquote class="text">
<p>
            This command allows the user to mount a different file
            system data structure without altering his login or
            accounting information.  Transfer parameters are similarly
            unchanged.  The argument is a pathname specifying a
            directory or other system dependent file group designator.

</p>
</blockquote>

<p>
         REINITIALIZE (REIN)
</p>
<blockquote class="text">
<p>
            This command terminates a USER, flushing all I/O and account
            information, except to allow any transfer in progress to be
            completed.  All parameters are reset to the default settings
            and the control connection is left open.  This is identical
            to the state in which a user finds himself immediately after
            the control connection is opened.  A USER command may be
            expected to follow.

</p>
</blockquote>

<p>
         LOGOUT (QUIT)
</p>
<blockquote class="text">
<p>
            This command terminates a USER and if file transfer is not
            in progress, the server closes the control connection.  If
            file transfer is in progress, the connection will remain
            open for result response and the server will then close it.
            If the user-process is transferring files for several USERs
            but does not wish to close and then reopen connections for
            each, then the REIN command should be used instead of QUIT.

</p>
<p>
            An unexpected close on the control connection will cause the
            server to take the effective action of an abort (ABOR) and a
            logout (QUIT).

</p>
</blockquote>

<a name="sec-4.1.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Transfer Parameter Commands</h3>

<p>
         All data transfer parameters have default values, and the
         commands specifying data transfer parameters are required only
         if the default parameter values are to be changed.  The default
         value is the last specified value, or if no value has been
         specified, the standard default value is as stated here.  This
         implies that the server must &quot;remember&quot; the applicable default
         values.  The commands MAY be in any order except that they MUST
         precede the FTP service request.  The following commands
         specify data transfer parameters:

</p>
<p>
DATA PORT (PORT)
</p>
<blockquote class="text">
<p>
            The argument is a HOST-PORT specification for the data port
            to be used in data connection.  There are defaults for both
            the user and server data ports, and under normal
            circumstances this command and its reply are not needed.  If
            this command is used, the argument is the concatenation of a
            32-bit internet host address and a 16-bit TCP port address.
            This address information is broken into 8-bit fields and the
            value of each field is transmitted as a decimal number (in
            character string representation).  The fields are separated
            by commas.  A port command would be:


</p>
<blockquote class="text">
<p>PORT h1,h2,h3,h4,p1,p2
</p>
</blockquote>


<p>
            where h1 is the high order 8 bits of the internet host
            address.

</p>
</blockquote><p>

</p>
<p>
         PASSIVE (PASV)
</p>
<blockquote class="text">
<p>
            This command requests the server-DTP to &quot;listen&quot; on a data
            port (which is not its default data port) and to wait for a
            connection rather than initiate one upon receipt of a
            transfer command.  The response to this command includes the
            host and port address this server is listening on.

</p>
</blockquote>

<p>
         REPRESENTATION TYPE (TYPE)
</p>
<blockquote class="text">
<p>
            The argument specifies the representation type as described
            in <a class='info' href='#sec-3.1.1'>Section&nbsp;3.1.1<span> (</span><span class='info'>Data Types</span><span>)</span></a>.  Several
            types take a second parameter.  The first parameter is
            denoted by a single Telnet character, as is the second
            Format parameter for ASCII and EBCDIC; the second parameter
            for local byte is a decimal integer to indicate Bytesize.
            The parameters are separated by a &lt;SP&gt; (Space, ASCII code
            32).

</p>
<p>
            The following codes are assigned for type:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                         \    /
               A - ASCII |    | N - Non-print
                         |-&gt;&lt;-| T - Telnet format effectors
               E - EBCDIC|    | C - Carriage Control (ASA)
                         /    \
               I - Image

               L &lt;byte size&gt; - Local byte Byte size
</pre></div><p>


</p>
<p>
            The default representation type is ASCII Non-print.  If the
            Format parameter is changed, and later just the first
            argument is changed, Format then returns to the Non-print
            default.

</p>
</blockquote>

<p>
         FILE STRUCTURE (STRU)
</p>
<blockquote class="text">
<p>
            The argument is a single Telnet character code specifying
            file structure described in <a class='info' href='#sec-3.1.2'>Section&nbsp;3.1.2<span> (</span><span class='info'>Data Structures</span><span>)</span></a>.

</p>
<p>
            The following codes are assigned for structure:
</p>
<blockquote class="text">
<p>F - File (no record structure)
</p>
<p>R - Record structure
</p>
<p>P - Page structure
</p>
</blockquote>


<p>
            The default structure is File.

</p>
</blockquote>

<p>
         TRANSFER MODE (MODE)
</p>
<blockquote class="text">
<p>
            The argument is a single Telnet character code specifying
            the data transfer modes described in <a class='info' href='#sec-3.4'>Section&nbsp;3.4<span> (</span><span class='info'>Transmission Modes</span><span>)</span></a>.

</p>
<p>
            The following codes are assigned for transfer modes:
</p>
<blockquote class="text">
<p>S - Stream
</p>
<p>B - Block
</p>
<p>C - Compressed
</p>
</blockquote>


<p>
            The default transfer mode is Stream.

</p>
</blockquote><p>
			
</p>
<a name="sec-4.1.2.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2.1"></a><h3>4.1.2.1.&nbsp;
Extensions for IPv6 and NATs: Extended Port (EPRT) and Extended Passive Mode (EPSV)</h3>

<p>
   Originally, the File Transfer Protocol <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> only provided the ability to
   communicate information about IPv4 <a class='info' href='#RFC0791'>[RFC0791]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> data connections.  FTP assumes
   network addresses will be 32 bits in length.  However, with the
   deployment of version 6 of the Internet Protocol <a class='info' href='#RFC2460'>[RFC2460]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> addresses
   will no longer be 32 bits long.  <a class='info' href='#RFC1639'>[RFC1639]<span> (</span><span class='info'>Piscitello, D., &ldquo;FTP Operation Over Big Address Records (FOOBAR),&rdquo; June&nbsp;1994.</span><span>)</span></a> (now obsolete) specifies
   extensions to FTP to enable its use over various network protocols.
   Unfortunately, the mechanism can fail in a multi-protocol
   environment.  During the transition between IPv4 and IPv6, FTP needs
   the ability to negotiate the network protocol that will be used for
   data transfer.

</p>
<p>
   This section provides a specification for a way that FTP can
   communicate data connection endpoint information for network
   protocols other than IPv4.  In this section, the FTP commands
   PORT and PASV are replaced with EPRT and EPSV, respectively.

</p>
<a name="4.1.2.1.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2.1.1"></a><h3>4.1.2.1.1.&nbsp;
The EPRT Command</h3>

<p>
   The EPRT command allows for the specification of an extended address
   for the data connection.  The extended address MUST consist of the
   network protocol as well as the network and transport addresses.  The
   format of EPRT is:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
           EPRT&lt;space&gt;&lt;d&gt;&lt;net-prt&gt;&lt;d&gt;&lt;net-addr&gt;&lt;d&gt;&lt;tcp-port&gt;&lt;d&gt;
</pre></div><p>


</p>
<p>
   The EPRT command keyword MUST be followed by a single space (ASCII
   32).  Following the space, a delimiter character (&lt;d&gt;) MUST be
   specified.  The delimiter character MUST be one of the ASCII
   characters in range 33-126 inclusive.  The character &quot;|&quot; (ASCII 124)
   is recommended unless it coincides with a character needed to encode
   the network address.

</p>
<p>
   The &lt;net-prt&gt; argument MUST be an address family number defined by
   the IANA "Port Numbers" Registry at http://www.iana.org/assignments/port-numbers.  This number indicates the protocol to be
   used (and, implicitly, the address length).  This document will use
   two of address family numbers from the IANA "Address Family Numbers" Registry at http://www.iana.org/assignments/address-family-numbers/address-family-numbers.xhtml as examples, according to
   the following table:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        AF Number   Protocol
        ---------   --------
        1           Internet Protocol, Version 4 [RFC0791]
        2           Internet Protocol, Version 6 [RFC2460]
</pre></div><p>



</p>
<p>
   The &lt;net-addr&gt; is a protocol specific string representation of the
   network address.  For the two address families specified above (AF
   Number 1 and 2), addresses MUST be in the following format:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        AF Number   Address Format      Example
        ---------   --------------      -------
        1           dotted decimal      132.235.1.2
        2           IPv6 string         1080::8:800:200C:417A
                    representations
                    defined in [RFC2460]
</pre></div><p>



</p>
<p>
   The &lt;tcp-port&gt; argument must be the string representation of the
   number of the TCP port on which the host is listening for the data
   connection.

</p>
<p>
   The following are sample EPRT commands:
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

        EPRT |1|132.235.1.2|6275|

        EPRT |2|1080::8:800:200C:417A|5282|
</pre></div><p>


</p>
<p>
   The first command specifies that the server should use IPv4 to open a
   data connection to the host &quot;132.235.1.2&quot; on TCP port 6275.  The
   second command specifies that the server should use the IPv6 network
   protocol and the network address &quot;1080::8:800:200C:417A&quot; to open a
   TCP data connection on port 5282.

</p>
<p>
   Upon receipt of a valid EPRT command, the server MUST return a code
   of 200 (Command OK).  The standard negative error code 500 and 501
   <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> are sufficient to handle most errors (e.g., syntax errors)
   involving the EPRT command.  However, an additional error code is
   needed.  The response code 522 indicates that the server does not
   support the requested network protocol.  The interpretation of this
   new error code is:
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        5yz Negative Completion
        x2z Connections
        xy2 Extended Port Failure - unknown network protocol
</pre></div><p>



</p>
<p>
   The text portion of the response MUST indicate which network
   protocols the server does support.  If the network protocol is
   unsupported, the format of the response string MUST be:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        &lt;text stating that the network protocol is unsupported&gt; \
            (prot1,prot2,...,protn)
</pre></div><p>



</p>
<p>
   Both the numeric code specified above and the protocol information
   between the characters '(' and ')' are intended for the software
   automata receiving the response; the textual message between the
   numeric code and the '(' is intended for the human user and can be
   any arbitrary text, but MUST NOT include the characters '(' and ')'.
   In the above case, the text SHOULD indicate that the network protocol
   in the EPRT command is not supported by the server.  The list of
   protocols inside the parenthesis MUST be a comma separated list of
   address family numbers.  Two example response strings follow:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Network protocol not supported, use (1)

        Network protocol not supported, use (1,2)

</pre></div><p>


</p>
<a name="4.1.2.1.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2.1.2"></a><h3>4.1.2.1.2.&nbsp;
The EPSV Command</h3>

<p>
   The EPSV command requests that a server listen on a data port and
   wait for a connection.  The EPSV command takes an optional argument.
   The response to this command includes only the TCP port number of the
   listening connection.  The format of the response, however, is
   similar to the argument of the EPRT command.  This allows the same
   parsing routines to be used for both commands.  In addition, the
   format leaves a place holder for the network protocol and/or network
   address, which may be needed in the EPSV response in the future.  The
   response code for entering passive mode using an extended address
   MUST be 229.  The interpretation of this code, according to <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>
   is:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        2yz Positive Completion
        x2z Connections
        xy9 Extended Passive Mode Entered

   The text returned in response to the EPSV command MUST be:

        &lt;text indicating server is entering extended passive mode&gt; \
            (&lt;d&gt;&lt;d&gt;&lt;d&gt;&lt;tcp-port&gt;&lt;d&gt;)
</pre></div><p>


</p>
<p>
   The portion of the string enclosed in parentheses MUST be the exact
   string needed by the EPRT command to open the data connection, as
   specified above.

</p>
<p>
   The first two fields contained in the parenthesis MUST be blank.  The
   third field MUST be the string representation of the TCP port number
   on which the server is listening for a data connection.  The network
   protocol used by the data connection will be the same network
   protocol used by the control connection.  In addition, the network
   address used to establish the data connection will be the same
   network address used for the control connection.  An example response
   string follows:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Entering Extended Passive Mode (|||6446|)
</pre></div><p>



</p>
<p>
   The standard negative error codes 500 and 501 are sufficient to
   handle all errors involving the EPSV command (e.g., syntax errors).

</p>
<p>
   When the EPSV command is issued with no argument, the server will
   choose the network protocol for the data connection based on the
   protocol used for the control connection.  However, in the case of
   proxy FTP, this protocol might not be appropriate for communication
   between the two servers.  Therefore, the client needs to be able to
   request a specific protocol.  If the server returns a protocol that
   is not supported by the host that will be connecting to the port, the
   client MUST issue an ABOR (abort) command to allow the server to
   close down the listening connection.  The client can then send an
   EPSV command requesting the use of a specific network protocol, as
   follows:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        EPSV&lt;space&gt;&lt;net-prt&gt;
</pre></div><p>



</p>
<p>
   If the requested protocol is supported by the server, it SHOULD use
   the protocol.  If not, the server MUST return the 522 error messages
   as outlined in section 2.

</p>
<p>
   Finally, the EPSV command can be used with the argument &quot;ALL&quot; to
   inform Network Address Translators that the EPRT command (as well as
   other data commands) will no longer be used.  An example of this
   command follows:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        EPSV&lt;space&gt;ALL
</pre></div><p>



</p>
<p>
   Upon receipt of an EPSV ALL command, the server MUST reject all data
   connection setup commands other than EPSV (i.e., EPRT, PORT, PASV, et
   al.).  This use of the EPSV command is further explained in section
   4.

</p>
<p>

</p>
<a name="4.1.2.1.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2.1.3"></a><h3>4.1.2.1.3.&nbsp;
Command Usage</h3>

<p>
   For all FTP transfers where the control and data connection(s) are
   being established between the same two machines, the EPSV command
   MUST be used.  Using the EPSV command benefits performance of
   transfers that traverse firewalls or Network Address Translators
   (NATs).  RFC 1579 recommends using the passive command when
   behind firewalls since firewalls do not generally allow incoming
   connections (which are required when using the PORT (EPRT) command).
   In addition, using EPSV as defined in this document does not require
   NATs to change the network address in the traffic as it is forwarded.
   The NAT would have to change the address if the EPRT command was
   used.  Finally, if the client issues an &quot;EPSV ALL&quot; command, NATs may
   be able to put the connection on a &quot;fast path&quot; through the
   translator, as the EPRT command will never be used and therefore,
   translation of the data portion of the segments will never be needed.
   When a client only expects to do two-way FTP transfers, it SHOULD
   issue this command as soon as possible.  If a client later finds that
   it must do a three-way FTP transfer after issuing an EPSV ALL
   command, a new FTP session MUST be started.

</p>
<a name="sec-4.1.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
FTP Service Commands</h3>

<p>
         The FTP service commands define the file transfer or the file
         system function requested by the user.  The argument of an FTP
         service command will normally be a pathname.  The syntax of
         pathnames must conform to server site conventions (with
         standard defaults applicable), and the language conventions of
         the control connection.  The suggested default handling is to
         use the last specified device, directory or file name, or the
         standard default defined for local users.  The commands MAY be
         in any order except that a &quot;rename from&quot; command MUST be
         followed by a &quot;rename to&quot; command and the restart command MUST
         be followed by the interrupted service command (e.g., STOR or
         RETR).  The data, when transferred in response to FTP service
         commands, shall always be sent over the data connection, except
         for certain informative replies.  The following commands
         specify FTP service requests:

</p>
<p>
         RETRIEVE (RETR)
</p>
<blockquote class="text">
<p>
            This command causes the server-DTP to transfer a copy of the
            file, specified in the pathname, to the server- or user-DTP
            at the other end of the data connection.  The status and
            contents of the file at the server site shall be unaffected.

</p>
</blockquote>

<p>
         STORE (STOR)
</p>
<blockquote class="text">
<p>
            This command causes the server-DTP to accept the data
            transferred via the data connection and to store the data as
            a file at the server site.  If the file specified in the
            pathname exists at the server site, then its contents shall
            be replaced by the data being transferred.  A new file is
            created at the server site if the file specified in the
            pathname does not already exist.

</p>
</blockquote>

<p>
         STORE UNIQUE (STOU)
</p>
<blockquote class="text">
<p>
            This command behaves like STOR except that the resultant
            file is to be created in the current directory under a name
            unique to that directory.  The 250 Transfer Started response
            must include the name generated.

</p>
</blockquote>

<p>
         APPEND (with create) (APPE)
</p>
<blockquote class="text">
<p>
            This command causes the server-DTP to accept the data
            transferred via the data connection and to store the data in
            a file at the server site.  If the file specified in the
            pathname exists at the server site, then the data shall be
            appended to that file; otherwise the file specified in the
            pathname shall be created at the server site.

</p>
</blockquote>

<p>
         ALLOCATE (ALLO)
</p>
<blockquote class="text">
<p>
            This command may be required by some servers to reserve
            sufficient storage to accommodate the new file to be
            transferred.  The argument shall be a decimal integer
            representing the number of bytes (using the logical byte
            size) of storage to be reserved for the file.  For files
            sent with record or page structure a maximum record or page
            size (in logical bytes) might also be necessary; this is
            indicated by a decimal integer in a second argument field of
            the command.  This second argument is optional, but when
            present should be separated from the first by the three
            Telnet characters &lt;SP&gt; R &lt;SP&gt;.  This command shall be
            followed by a STORe or APPEnd command.  The ALLO command
            should be treated as a NOOP (no operation) by those servers
            which do not require that the maximum size of the file be
            declared beforehand, and those servers interested in only
            the maximum record or page size should accept a dummy value
            in the first argument and ignore it.

</p>
</blockquote>

<p>
         RESTART (REST)
</p>
<blockquote class="text">
<p>
            The argument field represents the server marker at which
            file transfer is to be restarted.  This command does not
            cause file transfer but skips over the file to the specified
            data checkpoint.  This command shall be immediately followed
            by the appropriate FTP service command which shall cause
            file transfer to resume.

</p>
</blockquote>

<p>
         RENAME FROM (RNFR)
</p>
<blockquote class="text">
<p>
            This command specifies the old pathname of the file which is
            to be renamed.  This command MUST be immediately followed by
            a &quot;rename to&quot; command specifying the new file pathname.

</p>
</blockquote>

<p>
         RENAME TO (RNTO)
</p>
<blockquote class="text">
<p>
            This command specifies the new pathname of the file
            specified in the immediately preceding &quot;rename from&quot;
            command.  Together the two commands cause a file to be
            renamed.

</p>
</blockquote>

<p>
         ABORT (ABOR)
</p>
<blockquote class="text">
<p>
            This command tells the server to abort the previous FTP
            service command and any associated transfer of data.  The
            abort command may require &quot;special action&quot;, as discussed in
            the "Special Action" portion at the end of <a class='info' href='#sec-4.1.3'>Section&nbsp;4.1.3<span> (</span><span class='info'>FTP Service Commands</span><span>)</span></a>, to force recognition by the
            server.  No action is to be taken if the previous command
            has been completed (including data transfer).  The control
            connection is not to be closed by the server, but the data
            connection must be closed.

</p>
<p>
            There are two cases for the server upon receipt of this
            command: (1) the FTP service command was already completed,
            or (2) the FTP service command is still in progress.

</p>
<p>
               In the first case, the server closes the data connection
               (if it is open) and responds with a 226 reply, indicating
               that the abort command was successfully processed.

</p>
<p>
               In the second case, the server aborts the FTP service in
               progress and closes the data connection, returning a 426
               reply to indicate that the service request terminated
               abnormally.  The server then sends a 226 reply,
               indicating that the abort command was successfully
               processed.

</p>
</blockquote>

<p>
         DELETE (DELE)
</p>
<blockquote class="text">
<p>
            This command causes the file specified in the pathname to be
            deleted at the server site.  If an extra level of protection
            is desired (such as the query, &quot;Do you really wish to
            delete?&quot;), it should be provided by the user-FTP process.

</p>
</blockquote>

<p>
         REMOVE DIRECTORY (RMD)
</p>
<blockquote class="text">
<p>
            This command causes the directory specified in the pathname
            to be removed as a directory (if the pathname is absolute)
            or as a subdirectory of the current working directory (if
            the pathname is relative).  See <a class='info' href='#Appendix-B'>Appendix&nbsp;B<span> (</span><span class='info'>Directory Commands</span><span>)</span></a>.

</p>
</blockquote>

<p>
         MAKE DIRECTORY (MKD)
</p>
<blockquote class="text">
<p>
            This command causes the directory specified in the pathname
            to be created as a directory (if the pathname is absolute)
            or as a subdirectory of the current working directory (if
            the pathname is relative).  See <a class='info' href='#Appendix-B'>Appendix&nbsp;B<span> (</span><span class='info'>Directory Commands</span><span>)</span></a>.

</p>
</blockquote>

<p>
         PRINT WORKING DIRECTORY (PWD)
</p>
<blockquote class="text">
<p>
            This command causes the name of the current working
            directory to be returned in the reply.  See <a class='info' href='#Appendix-B'>Appendix&nbsp;B<span> (</span><span class='info'>Directory Commands</span><span>)</span></a>.

</p>
</blockquote>

<p>
         LIST (LIST)
</p>
<blockquote class="text">
<p>
            This command causes a list to be sent from the server to the
            passive DTP.  If the pathname specifies a directory or other
            group of files, the server should transfer a list of files
            in the specified directory.  If the pathname specifies a
            file then the server should send current information on the
            file.  A null argument implies the user's current working or
            default directory.  The data transfer is over the data
            connection in type ASCII or type EBCDIC.  (The user must
            ensure that the TYPE is appropriately ASCII or EBCDIC).
            Since the information on a file may vary widely from system
            to system, this information may be hard to use automatically
            in a program, but may be quite useful to a human user.

</p>
</blockquote>

<p>
         NAME LIST (NLST)
</p>
<blockquote class="text">
<p>
            This command causes a directory listing to be sent from
            server to user site.  The pathname should specify a
            directory or other system-specific file group descriptor; a
            null argument implies the current directory.  The server
            will return a stream of names of files and no other
            information.  The data will be transferred in ASCII or
            EBCDIC type over the data connection as valid pathname
            strings separated by &lt;CRLF&gt; or &lt;NL&gt;.  (Again the user must
            ensure that the TYPE is correct.)  This command is intended
            to return information that can be used by a program to
            further process the files automatically.  For example, in
            the implementation of a &quot;multiple get&quot; function.

</p>
</blockquote>

<p>
         SITE PARAMETERS (SITE)
</p>
<blockquote class="text">
<p>
            This command is used by the server to provide services
            specific to his system that are essential to file transfer
            but not sufficiently universal to be included as commands in
            the protocol.  The nature of these services and the
            specification of their syntax can be stated in a reply to
            the HELP SITE command.

</p>
</blockquote>

<p>
         SYSTEM (SYST)
</p>
<blockquote class="text">
<p>
            This command is used to find out the type of operating
            system at the server.  The reply shall have as its first
            word one of the system names listed in the current version
            of the IANA "Operating System Names" Registry ( http://www.iana.org/assignments/operating-system-names at
the time of this writing)


</p>
</blockquote>

<p>
         STATUS (STAT)
</p>
<blockquote class="text">
<p>
            This command shall cause a status response to be sent over
            the control connection in the form of a reply.  The command
            MAY be sent during a file transfer (along with the Telnet IP
            and Synch signals--see the "Special Action" portion at the end of <a class='info' href='#sec-4.1.3'>Section&nbsp;4.1.3<span> (</span><span class='info'>FTP Service Commands</span><span>)</span></a>) in which
            case the server will respond with the status of the
            operation in progress, or it MAY be sent between file
            transfers.  In the latter case, the command MAY have an
            argument field.  If the argument is a pathname, the command
            is analogous to the &quot;list&quot; command except that data shall be
            transferred over the control connection.  If a partial
            pathname is given, the server MAY respond with a list of
            file names or attributes associated with that specification.
            If no argument is given, the server should return general
            status information about the server FTP process.  This
            should include current values of all transfer parameters and
            the status of connections.

</p>
</blockquote>

<p>
         HELP (HELP)
</p>
<blockquote class="text">
<p>
            This command shall cause the server to send helpful
            information regarding its implementation status over the
            control connection to the user.  The command MAY take an
            argument (e.g., any command name) and return more specific
            information as a response.  The reply is type 211 or 214.
            It is suggested that HELP be allowed before entering a USER
            command. The server MAY use this reply to specify
            site-dependent parameters, e.g., in response to HELP SITE.

</p>
</blockquote>

<p>
         NOOP (NOOP)
</p>
<blockquote class="text">
<p>
            This command does not affect any parameters or previously
            entered commands. It specifies no action other than that the
            server send an OK reply.

</p>
</blockquote>

<p>
   The File Transfer Protocol follows the specifications of the Telnet
   protocol for all communications over the control connection.  Since
   the language used for Telnet communication may be a negotiated
   option, all references in the next two sections will be to the
   &quot;Telnet language&quot; and the corresponding &quot;Telnet end-of-line code&quot;.
   Currently, one may take these to mean NVT-ASCII and &lt;CRLF&gt;.  No other
   specifications of the Telnet protocol will be cited.

</p>
<p>
   FTP commands are &quot;Telnet strings&quot; terminated by the &quot;Telnet end of
   line code&quot;.  The command codes themselves are alphabetic characters
   terminated by the character &lt;SP&gt; (Space) if parameters follow and
   Telnet-EOL otherwise.  The command codes and the semantics of
   commands are described in this section; the detailed syntax of
   commands is specified in <a class='info' href='#sec-5.3'>Section&nbsp;5.3<span> (</span><span class='info'>Commands</span><span>)</span></a>, the reply sequences
   are discussed in <a class='info' href='#sec-5.4'>Section&nbsp;5.4<span> (</span><span class='info'>Sequencing of Commands and Replies</span><span>)</span></a>,
   and scenarios illustrating the use of commands are provided in <a class='info' href='#sec-7'>Section&nbsp;7<span> (</span><span class='info'>Typical FTP Scenario</span><span>)</span></a>.

</p>
<p>
Special Action

</p>
<p>
   FTP commands may be partitioned as those specifying access-control
   identifiers, data transfer parameters, or FTP service requests.
   Certain commands (such as ABOR, STAT, QUIT) MAY be sent over the
   control connection while a data transfer is in progress.  Some
   servers may not be able to monitor the control and data connections
   simultaneously, in which case some special action will be necessary
   to get the server's attention.  The following ordered format is
   tentatively recommended:
</p>
<blockquote class="text">
<p>
      1. User system inserts the Telnet "Interrupt Process" (IP) signal
      in the Telnet stream.

</p>
<p>
      2. User system sends the Telnet "Synch" signal.

</p>
<p>
      3. User system inserts the command (e.g., ABOR) in the Telnet
      stream.

</p>
<p>
      4. Server PI, after receiving "IP", scans the Telnet stream for
      EXACTLY ONE FTP command.

</p>
</blockquote><p>

</p>
<p>
   (For other servers this may not be necessary but the actions listed
   above should have no unusual effect.)

</p>
<a name="sec-4.1.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4"></a><h3>4.1.4.&nbsp;
Feature Negotiation Mechanism</h3>

<p>
   The &quot;FEAT&quot; and &quot;OPTS&quot; commands allow a client to discover which optional commands a
   server supports, and how they are supported, and to select among
   various options that any FTP command may support.

</p>
<p>
   It is not to be expected that all servers will necessarily support
   all of the new commands defined in all future amendments to the FTP
   protocol.  In order to permit clients to determine which new commands
   are supported by a particular server, without trying each possible
   command, one new command is added to the FTP command repertoire.
   This command requests the server to list all extension commands, or
   extended mechanisms, that it supports.  That is, all defined and
   specified commands and features not defined in <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>, or this document,
   must be included in the FEAT command output in the form specified in
   the document that defines the extension.

</p>
<p>
   User-FTP PIs must expect to see, in FEAT command responses, unknown
   features listed.  This is not an error, and simply indicates that the
   server-FTP implementor has seen, and implemented, the specification
   of a new feature that is unknown to the user-FTP.

</p>
<a name="sec-4.1.4.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4.1"></a><h3>4.1.4.1.&nbsp;
Feature (FEAT) Command Syntax</h3>

<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        feat            = "Feat" CRLF
</pre></div><p>



</p>
<p>
   The FEAT command consists solely of the word &quot;FEAT&quot;.  It has no
   parameters or arguments.

</p>
<p>

</p>
<a name="sec-4.1.4.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4.2"></a><h3>4.1.4.2.&nbsp;
FEAT Command Responses</h3>

<p>
   Where a server-FTP process does not support the FEAT command, it will
   respond to the FEAT command with a 500 or 502 reply.  This is simply
   the normal &quot;unrecognized command&quot; reply that any unknown command
   would elicit.  Errors in the command syntax, such as giving
   parameters, will result in a 501 reply.

</p>
<p>
   Server-FTP processes that recognize the FEAT command, but implement
   no extended features, and therefore have nothing to report, SHOULD
   respond with the &quot;no-features&quot; 211 reply.  However, as this case is
   practically indistinguishable from a server-FTP that does not
   recognize the FEAT command, a 500 or 502 reply MAY also be used.  The
   &quot;no-features&quot; reply MUST NOT use the multi-line response format,
   exactly one response line is required and permitted.

</p>
<p>
   Replies to the FEAT command MUST comply with the following syntax.
   Text on the first line of the reply is free form, and not
   interpreted, and has no practical use, as this text is not expected
   to be revealed to end users.  The syntax of other reply lines is
   precisely defined, and if present, MUST be exactly as specified.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     feat-response   = error-response / no-features / feature-listing
     no-features     = "211" SP *TCHAR CRLF
     feature-listing = "211-" *TCHAR CRLF
                       1*( SP feature CRLF )
                       "211 End" CRLF
     feature         = feature-label [ SP feature-parms ]
     feature-label   = 1*VCHAR
     feature-parms   = 1*TCHAR
</pre></div><p>



</p>
<p>
   Note that each feature line in the feature-listing begins with a
   single space.  That space is not optional, nor does it indicate
   general white space.  This space guarantees that the feature line can

</p>
<p>
   never be misinterpreted as the end of the feature-listing, but is
   required even where there is no possibility of ambiguity.

</p>
<p>
   Each extension supported must be listed on a separate line to
   facilitate the possible inclusion of parameters supported by each
   extension command.  The feature-label to be used in the response to
   the FEAT command will be specified as each new feature is added to
   the FTP command set.  Often it will be the name of a new command
   added, however this is not required.  In fact it is not required that
   a new feature actually add a new command.  Any parameters included
   are to be specified with the definition of the command concerned.
   That specification shall also specify how any parameters present are
   to be interpreted.

</p>
<p>
   The feature-label and feature-parms are nominally case sensitive,
   however the definitions of specific labels and parameters specify the
   precise interpretation, and it is to be expected that those
   definitions will usually specify the label and parameters in a case
   independent manner.  Where this is done, implementations are
   recommended to use upper case letters when transmitting the feature
   response.

</p>
<p>
   The FEAT command itself is not included in the list of features
   supported, support for the FEAT command is indicated by return of a
   reply other than a 500 or 502 reply.

</p>
<p>
   A typical example reply to the FEAT command might be a multiline
   reply of the form:

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        C&gt; feat
        S&gt; 211-Extensions supported:
        S&gt;  MLST size*;create;modify*;perm;media-type
        S&gt;  SIZE
        S&gt;  COMPRESSION
        S&gt;  MDTM
        S&gt; 211 END
</pre></div><p>



</p>
<p>
   The particular extensions shown here are simply examples of what may
   be defined in other places, no particular meaning should be
   attributed to them.  Recall also, that the feature names returned are
   not command names, as such, but simply indications that the server
   possesses some attribute or other.

</p>
<p>
   The order in which the features are returned is of no importance,
   server-FTP processes are not required to implement any particular
   order, or even to consistently return the same order when the command
   is repeated.

</p>
<p>
   FTP implementations which support FEAT MUST include in the response
   to the FEAT command all properly documented FTP extensions beyond
   those commands and mechanisms described in RFC959, including any
   which existed before the existence of FEAT.  That is, when a client
   receives a FEAT response from an FTP server, it can assume that the
   only extensions the server supports are those that are listed in the
   FEAT response.

</p>
<p>
   User-FTP processes should, however, be aware that there have been
   several FTP extensions developed, and in widespread use, prior to the
   adoption of this document and the FEAT command.  The effect of this
   is that an error response to the FEAT command does not necessarily
   imply that those extensions are not supported by the server-FTP
   process.  User-PIs should test for such extensions individually if an
   error response has been received to the FEAT command.

</p>
<a name="sec-4.1.4.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4.3"></a><h3>4.1.4.3.&nbsp;
Rationale for FEAT</h3>

<p>
   While not absolutely necessary, a standard mechanism for the server-PI to inform the user-PI of any features and extensions supported
   will help reduce unnecessary traffic between the user-PI and server-PI as more extensions may be introduced in the future.  If no
   mechanism existed for this, a user-FTP process would have to try each
   extension in turn resulting in a series of exchanges between the
   user-PI and server-PI.  Apart from being possibly wasteful, this
   procedure may not always be possible, as issuing of a command just to
   determine if it is supported or not may have some effect that is not
   desired.

</p>
<p>

</p>
<a name="sec-4.1.4.5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4.4"></a><h3>4.1.4.4.&nbsp;
The OPTS Command</h3>

<p>
   The OPTS (options) command allows a user-PI to specify the desired
   behavior of a server-FTP process when another FTP command (the target
   command) is later issued.  The exact behavior, and syntax, will vary
   with the target command indicated, and will be specified with the
   definition of that command.  Where no OPTS behavior is defined for a
   particular command there are no options available for that command.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Request Syntax:
     opts             = opts-cmd SP command-name
                            [ SP command-options ] CRLF
     opts-cmd         = "opts"
     command-name     = &lt;any FTP command which allows option setting&gt;
     command-options  = &lt;format specified by individual FTP command&gt;

Response Syntax:
     opts-response    = opts-good / opts-bad
     opts-good        = "200" SP response-message CRLF
     opts-bad         = "451" SP response-message CRLF /
                        "501" SP response-message CRLF
     response-message = *TCHAR

</pre></div><p>


</p>
<p>
   An &quot;opts-good&quot; response (200 reply) MUST be sent when the command-name specified in the OPTS command is recognized, and the command-
   options, if any, are recognized, and appropriate.  An &quot;opts-bad&quot;
   response is sent in other cases.  A 501 reply is appropriate for any
   permanent error.  That is, for any case where simply repeating the
   command at some later time, without other changes of state, will also
   be an error.  A 451 reply should be sent where some temporary
   condition at the server, not related to the state of communications
   between user and server, prevents the command being accepted when
   issued, but where if repeated at some later time, a changed
   environment for the server-FTP process may permit the command to
   succeed.  If the OPTS command itself is not recognized, a 500 or 502
   reply will, of course, result.

</p>
<p>
   The OPTS command MUST be implemented whenever the FEAT command is
   implemented.  Because of that, there is no indication in the list of
   features returned by FEAT to indicate that the OPTS command itself is
   supported.  Neither the FEAT command, nor the OPTS command, have any
   optional functionality, thus there are no &quot;OPTS FEAT&quot; or &quot;OPTS OPTS&quot;
   commands.

</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.5"></a><h3>4.1.5.&nbsp;
Other Extensions</h3>

<p></p>
<blockquote class="text">
<p><a class='info' href='#RFC2228'>[RFC2228]<span> (</span><span class='info'>Horowitz, M., &ldquo;FTP Security Extensions,&rdquo; October&nbsp;1997.</span><span>)</span></a> describes OPTIONAL extensions: AUTH, ADAT, PROT, PBSZ, CCC, MIC, CONF, ENC.
</p>
<p><a class='info' href='#RFC2640'>[RFC2640]<span> (</span><span class='info'>Curtin, B., &ldquo;Internationalization of the File Transfer Protocol,&rdquo; July&nbsp;1999.</span><span>)</span></a> describes OPTIONAL extension: LANG.
</p>
<p><a class='info' href='#RFC3659'>[RFC3659]<span> (</span><span class='info'>Hethmon, P., &ldquo;Extensions to FTP,&rdquo; March&nbsp;2007.</span><span>)</span></a> describes OPTIONAL extensions: MDTM, SIZE, REST, TVFS, MLST, MLSD.
</p>
</blockquote><p>

</p>
<a name="sec-4.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
FTP Replies</h3>

<p>
      Replies to File Transfer Protocol commands are devised to ensure
      the synchronization of requests and actions in the process of file
      transfer, and to guarantee that the user process always knows the
      state of the Server.  Every command MUST generate at least one
      reply, although there MAY be more than one; in the latter case,
      the multiple replies MUST be easily distinguished.  In addition,
      some commands occur in sequential groups, such as USER, PASS and
      ACCT, or RNFR and RNTO.  The replies show the existence of an
      intermediate state if all preceding commands have been successful.
      A failure at any point in the sequence necessitates the repetition
      of the entire sequence from the beginning.
</p>
<blockquote class="text">
<p>
         The details of the command-reply sequence are made explicit in
         a set of state diagrams below.

</p>
</blockquote><p>

</p>
<p>
      An FTP reply consists of a three digit number (transmitted as
      three alphanumeric characters) followed by some text.  The number
      is intended for use by automata to determine what state to enter
      next; the text is intended for the human user.  It is intended
      that the three digits contain enough encoded information that the
      user-process (the User-PI) will not need to examine the text and
      MAY either discard it or pass it on to the user, as appropriate.
      In particular, the text MAY be server-dependent, so there are
      likely to be varying texts for each reply code.

</p>
<p>
      A reply is defined to contain the 3-digit code, followed by Space
      &lt;SP&gt;, followed by one line of text (where some maximum line length
      has been specified), and terminated by the Telnet end-of-line
      code.  There will be cases however, where the text is longer than
      a single line.  In these cases the complete text must be bracketed
      so the User-process knows when it MAY stop reading the reply (i.e.
      stop processing input on the control connection) and go do other
      things.  This requires a special format on the first line to
      indicate that more than one line is coming, and another on the
      last line to designate it as the last.  At least one of these must
      contain the appropriate reply code to indicate the state of the
      transaction.  To satisfy all factions, it was decided that both
      the first and last line codes should be the same.

</p>
<p>
         Thus the format for multi-line replies is that the first line
         will begin with the exact required reply code, followed
         immediately by a Hyphen, &quot;-&quot; (also known as Minus), followed by
         text.  The last line will begin with the same code, followed
         immediately by Space &lt;SP&gt;, optionally some text, and the Telnet
         end-of-line code.

</p>
<p>
	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            For example:
                                123-First line
                                Second line
                                  234 A line beginning with numbers
                                123 The last line
</pre></div><p>


</p>
<p>
         The user-process then simply needs to search for the second
         occurrence of the same reply code, followed by &lt;SP&gt; (Space), at
         the beginning of a line, and ignore all intermediary lines.  If
         an intermediary line begins with a 3-digit number, the Server
         must pad the front  to avoid confusion.

</p>
<p>
            This scheme allows standard system routines to be used for
            reply information (such as for the STAT reply), with
            &quot;artificial&quot; first and last lines tacked on.  In rare cases
            where these routines are able to generate three digits and a
            Space at the beginning of any line, the beginning of each
            text line should be offset by some neutral text, like Space.

</p>
<p>
         This scheme assumes that multi-line replies may not be nested.

</p>
<p>
      The three digits of the reply each have a special significance.
      This is intended to allow a range of very simple to very
      sophisticated responses by the user-process.  The first digit
      denotes whether the response is good, bad or incomplete.
      (Referring to the state diagram), an unsophisticated user-process
      will be able to determine its next action (proceed as planned,
      redo, retrench, etc.) by simply examining this first digit.  A
      user-process that wants to know approximately what kind of error
      occurred (e.g. file system error, command syntax error) MAY
      examine the second digit, reserving the third digit for the finest
      gradation of information (e.g., RNTO command without a preceding
      RNFR).

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      There are five values for the first digit of the reply code:

         1yz   Positive Preliminary reply

            The requested action is being initiated; expect another
            reply before proceeding with a new command.  (The
            user-process sending another command before the
            completion reply would be in violation of protocol; but
            server-FTP processes should queue any commands that
            arrive while a preceding command is in progress.)  This
            type of reply can be used to indicate that the command
            was accepted and the user-process may now pay attention
            to the data connections, for implementations where
            simultaneous monitoring is difficult.  The server-FTP
            process MAY send at most, one 1yz reply per command.

         2yz   Positive Completion reply

             The requested action has been successfully completed.  A
             new request may be initiated.

         3yz   Positive Intermediate reply

            The command has been accepted, but the requested action
            is being held in abeyance, pending receipt of further
            information.  The user should send another command
            specifying this information.  This reply is used in
            command sequence groups.

         4yz   Transient Negative Completion reply

            The command was not accepted and the requested action did
            not take place, but the error condition is temporary and
            the action MAY be requested again.  The user should
            return to the beginning of the command sequence, if any.
            It is difficult to assign a meaning to "transient",
            particularly when two distinct sites (Server- and
            User-processes) have to agree on the interpretation.
            Each reply in the 4yz category might have a slightly
            different time value, but the intent is that the
            user-process is encouraged to try again.  A rule of thumb
            in determining if a reply fits into the 4yz or the 5yz
            (Permanent Negative) category is that replies are 4yz if
            the commands can be repeated without any change in
            command form or in properties of the User or Server
            (e.g., the command is spelled the same with the same
            arguments used; the user does not change his file access
            or user name; the server does not put up a new
            implementation.)

         5yz   Permanent Negative Completion reply

            The command was not accepted and the requested action did
            not take place.  The User-process is discouraged from
            repeating the exact request (in the same sequence).  Even
            some "permanent" error conditions can be corrected, so
            the human user may want to direct his User-process to
            reinitiate the command sequence by direct action at some
            point in the future (e.g., after the spelling has been
            changed, or the user has altered his directory status.)
</pre></div><p>


</p>
<p>
         The following function groupings are encoded in the second
         digit:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         x0z   Syntax - These replies refer to syntax errors,
               syntactically correct commands that don't fit any
               functional category, unimplemented or superfluous
               commands.

         x1z   Information -  These are replies to requests for
               information, such as status or help.

         x2z   Connections - Replies referring to the control and
               data connections.

         x3z   Authentication and accounting - Replies for the login
               process and accounting procedures.

         x4z   Unspecified as yet.

         x5z   File system - These replies indicate the status of the
               Server file system vis-a-vis the requested transfer or
               other file system action.
</pre></div><p>


</p>
<p>
         The third digit gives a finer gradation of meaning in each of
         the function categories, specified by the second digit.  The
         list of replies below will illustrate this.  Note that the text
         associated with each reply is recommended, rather than
         mandatory, and MAY even change according to the command with
         which it is associated.  The reply codes, on the other hand,
         MUST strictly follow the specifications in the last section;
         that is, Server implementations SHOULD NOT invent new codes for
         situations that are only slightly different from the ones
         described here, but rather SHOULD adapt codes already defined.

</p>
<p>
</p>
<blockquote class="text">
<p>
            A command such as TYPE or ALLO whose successful execution
            does not offer the user-process any new information will
            cause a 200 reply to be returned.  If the command is not
            implemented by a particular Server-FTP process because it
            has no relevance to that computer system, for example ALLO
            at a TOPS20 site, a Positive Completion reply is still
            desired so that the simple User-process knows it can proceed
            with its course of action.  A 202 reply is used in this case
            with, for example, the reply text:  &quot;No storage allocation
            necessary.&quot;  If, on the other hand, the command requests a
            non-site-specific action and is unimplemented, the response
            is 502.  A refinement of that is the 504 reply for a command
            that is implemented, but that requests an unimplemented
            parameter.

</p>
</blockquote><p>

</p>
<a name="sec-4.2.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Reply Code By Function Groups</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      200 Command okay.
      500 Syntax error, command unrecognized.
          This may include errors such as command line too long.
      501 Syntax error in parameters or arguments.
      202 Command not implemented, superfluous at this site.
      502 Command not implemented.
      503 Bad sequence of commands.
      504 Command not implemented for that parameter.
      110 Restart marker reply.
          In this case, the text is exact and not left to the
          particular implementation; it must read:
               MARK yyyy = mmmm
          Where yyyy is User-process data stream marker, and mmmm
          server's equivalent marker (note the spaces between markers
          and "=").
      211 System status, or system help reply.
      212 Directory status.
      213 File status.
      214 Help message.
          On how to use the server or the meaning of a particular
          non-standard command.  This reply is useful only to the
          human user.
      215 NAME system type.
          Where NAME is an official system name from the list in the
          Assigned Numbers document.

      120 Service ready in nnn minutes.
      220 Service ready for new user.
      221 Service closing control connection.
          Logged out if appropriate.
      421 Service not available, closing control connection.
          This may be a reply to any command if the service knows it
          must shut down.
      125 Data connection already open; transfer starting.
      225 Data connection open; no transfer in progress.
      425 Can't open data connection.
      226 Closing data connection.
          Requested file action successful (for example, file
          transfer or file abort).
      426 Connection closed; transfer aborted.
      227 Entering Passive Mode (h1,h2,h3,h4,p1,p2).

      230 User logged in, proceed.
      530 Not logged in.
      331 User name okay, need password.
      332 Need account for login.
      532 Need account for storing files.

      150 File status okay; about to open data connection.
      250 Requested file action okay, completed.
      257 "PATHNAME" created.
      350 Requested file action pending further information.
      450 Requested file action not taken.
          File unavailable (e.g., file busy).
      550 Requested action not taken.
          File unavailable (e.g., file not found, no access).
      451 Requested action aborted. Local error in processing.
      551 Requested action aborted. Page type unknown.
      452 Requested action not taken.
          Insufficient storage space in system.
      552 Requested file action aborted.
          Exceeded storage allocation (for current directory or
          dataset).
      553 Requested action not taken.
          File name not allowed.
</pre></div><p>
         

</p>
<a name="sec-4.2.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Numeric Order List of Reply Codes</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      110 Restart marker reply.
          In this case, the text is exact and not left to the
          particular implementation; it must read:
               MARK yyyy = mmmm
          Where yyyy is User-process data stream marker, and mmmm
          server's equivalent marker (note the spaces between markers
          and "=").
      120 Service ready in nnn minutes.
      125 Data connection already open; transfer starting.
      150 File status okay; about to open data connection.
      200 Command okay.
      202 Command not implemented, superfluous at this site.
      211 System status, or system help reply.
      212 Directory status.
      213 File status.
      214 Help message.
          On how to use the server or the meaning of a particular
          non-standard command.  This reply is useful only to the
          human user.
      215 NAME system type.
          Where NAME is an official system name from the list in the
          Assigned Numbers document.
      220 Service ready for new user.
      221 Service closing control connection.
          Logged out if appropriate.
      225 Data connection open; no transfer in progress.
      226 Closing data connection.
          Requested file action successful (for example, file
          transfer or file abort).
      227 Entering Passive Mode (h1,h2,h3,h4,p1,p2).
      230 User logged in, proceed.
      250 Requested file action okay, completed.
      257 "PATHNAME" created.
      331 User name okay, need password.
      332 Need account for login.
      350 Requested file action pending further information.

      421 Service not available, closing control connection.
          This may be a reply to any command if the service knows it
          must shut down.
      425 Can't open data connection.
      426 Connection closed; transfer aborted.
      450 Requested file action not taken.
          File unavailable (e.g., file busy).
      451 Requested action aborted: local error in processing.
      452 Requested action not taken.
          Insufficient storage space in system.
      500 Syntax error, command unrecognized.
          This may include errors such as command line too long.
      501 Syntax error in parameters or arguments.
      502 Command not implemented.
      503 Bad sequence of commands.
      504 Command not implemented for that parameter.
      530 Not logged in.
      532 Need account for storing files.
      550 Requested action not taken.
          File unavailable (e.g., file not found, no access).
      551 Requested action aborted: page type unknown.
      552 Requested file action aborted.
          Exceeded storage allocation (for current directory or
          dataset).
      553 Requested action not taken.
          File name not allowed.
</pre></div><p>
         

</p>
<a name="sec-5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Declarative Specifications</h3>

<a name="sec-5.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Minimum Implementation</h3>

<p>
      In order to make FTP workable without needless error messages, the
      following minimum implementation is required for all servers:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         TYPE - ASCII Non-print
         MODE - Stream
         STRUCTURE - File, Record
         COMMANDS - USER, QUIT, PORT,
                    TYPE, MODE, STRU,
                      for the default values
                    RETR, STOR,
                    NOOP.
</pre></div><p>

</p>
<p>
      The default values for transfer parameters are:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

         TYPE - ASCII Non-print
         MODE - Stream
         STRU - File
</pre></div><p>


</p>
<p>
      All hosts must accept the above as the standard defaults.

</p>
<a name="sec-5.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Connections</h3>

<p>
      The server protocol interpreter shall &quot;listen&quot; on Port L.  The
      user or user protocol interpreter shall initiate the full-duplex
      control connection.  Server- and user- processes should follow the
      conventions of the Telnet protocol as specified in the
      ARPA-Internet Protocol Handbook <a class='info' href='#IPTW'>[IPTW]<span> (</span><span class='info'>Feinler, E., &ldquo;Internet Protocol Transition Workbook,&rdquo; March&nbsp;1982.</span><span>)</span></a>.  Servers are under no
      obligation to provide for editing of command lines and MAY require
      that it be done in the user host.  The control connection shall be
      closed by the server at the user's request after all transfers and
      replies are completed.

</p>
<p>
      The user-DTP MUST &quot;listen&quot; on the specified data port; this may be
      the default user port (U) or a port specified in the PORT command.
      The server shall initiate the data connection from his own default
      data port (L-1) using the specified user data port.  The direction
      of the transfer and the port used will be determined by the FTP
      service command.

</p>
<p>
      Note that all FTP implementation MUST support data transfer using
      the default port, and that only the USER-PI MAY initiate the use
      of non-default ports.

</p>
<p>
      When data is to be transferred between two servers, A and B (refer
      to Figure 2), the user-PI, C, sets up control connections with
      both server-PI's.  One of the servers, say A, is then sent a PASV
      command telling him to &quot;listen&quot; on his data port rather than
      initiate a connection when he receives a transfer service command.
      When the user-PI receives an acknowledgment to the PASV command,
      which includes the identity of the host and port being listened
      on, the user-PI then sends A's port, a, to B in a PORT command; a
      reply is returned.  The user-PI may then send the corresponding
      service commands to A and B.  Server B initiates the connection
      and the transfer proceeds.  The command-reply sequence is listed
      below where the messages are vertically synchronous but
      horizontally asynchronous:

</p>
<p>


</p>
<p>	 </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      User-PI - Server A                User-PI - Server B
      ------------------                ------------------

      C-&gt;A : Connect                    C-&gt;B : Connect
      C-&gt;A : PASV
      A-&gt;C : 227 Entering Passive Mode. A1,A2,A3,A4,a1,a2
                                        C-&gt;B : PORT A1,A2,A3,A4,a1,a2
                                        B-&gt;C : 200 Okay
      C-&gt;A : STOR                       C-&gt;B : RETR
                 B-&gt;A : Connect to HOST-A, PORT-a

                             Figure 3
</pre></div><p>


</p>
<p>
      The data connection shall be closed by the server under the
      conditions described in <a class='info' href='#sec-3.2'>Section&nbsp;3.2<span> (</span><span class='info'>Establishing Data Connections</span><span>)</span></a>.  If the data connection is to be closed following a
      data transfer where closing the connection is not required to
      indicate the end-of-file, the server must do so immediately.
      Waiting until after a new transfer command is not permitted
      because the user-process will have already tested the data
      connection to see if it needs to do a &quot;listen&quot;; (remember that the
      user must &quot;listen&quot; on a closed data port BEFORE sending the
      transfer request).  To prevent a race condition here, the server
      sends a reply (226) after closing the data connection (or if the
      connection is left open, a &quot;file transfer completed&quot; reply (250)
      and the user-PI should wait for one of these replies before
      issuing a new transfer command).

</p>
<p>
      Any time either the user or server see that the connection is
      being closed by the other side, it should promptly read any
      remaining data queued on the connection and issue the close on its
      own side.

</p>
<a name="sec-5.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Commands</h3>

<p>
      The commands are Telnet character strings transmitted over the
      control connections as described in <a class='info' href='#sec-5.3.1'>Section&nbsp;5.3.1<span> (</span><span class='info'>FTP Commands</span><span>)</span></a>.
      The command functions and semantics are described in <a class='info' href='#sec-4.1.1'>Section&nbsp;4.1.1<span> (</span><span class='info'>Access Control Commands</span><span>)</span></a>, <a class='info' href='#sec-4.1.2'>Section&nbsp;4.1.2<span> (</span><span class='info'>Transfer Parameter Commands</span><span>)</span></a>, <a class='info' href='#sec-4.1.3'>Section&nbsp;4.1.3<span> (</span><span class='info'>FTP Service Commands</span><span>)</span></a>, and Miscellaneous Commands.  The command syntax
      is specified here.

</p>
<p>
      The commands begin with a command code followed by an argument
      field.  The command codes are four or fewer alphabetic characters.
      Upper and lower case alphabetic characters are to be treated
      identically.  Thus, any of the following MAY represent the
      retrieve command:

</p>
<p>


</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                  RETR    Retr    retr    ReTr    rETr</pre></div><p>



</p>
<p>
      This also applies to any symbols representing parameter values,
      such as "A" or "a" for ASCII TYPE.  The command codes and the argument
      fields are separated by one or more spaces.

</p>
<p>
      The argument field consists of a variable length character string
      ending with the character sequence &lt;CRLF&gt; (Carriage Return, Line
      Feed) for NVT-ASCII representation; for other negotiated languages
      a different end of line character might be used.  It should be
      noted that the server is to take no action until the end of line
      code is received.

</p>
<p>
      The syntax is specified below in NVT-ASCII.  All characters in the
      argument field are ASCII characters including any ASCII
      represented decimal integers.  Square brackets denote an optional
      argument field.  If the option is not taken, the appropriate
      default is implied.

</p>
<p>


</p>
<a name="sec-5.3.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
FTP Commands</h3>

<p>
         The following are the FTP commands:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            USER &lt;SP&gt; &lt;username&gt; &lt;CRLF&gt;
            PASS &lt;SP&gt; &lt;password&gt; &lt;CRLF&gt;
            ACCT &lt;SP&gt; &lt;account-information&gt; &lt;CRLF&gt;
            CWD  &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            CDUP &lt;CRLF&gt;
            SMNT &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            QUIT &lt;CRLF&gt;
            REIN &lt;CRLF&gt;
            PORT &lt;SP&gt; &lt;host-port&gt; &lt;CRLF&gt;
            PASV &lt;CRLF&gt;
            TYPE &lt;SP&gt; &lt;type-code&gt; &lt;CRLF&gt;
            STRU &lt;SP&gt; &lt;structure-code&gt; &lt;CRLF&gt;
            MODE &lt;SP&gt; &lt;mode-code&gt; &lt;CRLF&gt;
FIXME       EPRT&lt;space&gt;&lt;d&gt;&lt;net-prt&gt;&lt;d&gt;&lt;net-addr&gt;&lt;d&gt;&lt;tcp-port&gt;&lt;d&gt;
FIXME       EPSV&lt;space&gt;&lt;net-prt&gt;
            RETR &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            STOR &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            STOU &lt;CRLF&gt;
            APPE &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            ALLO &lt;SP&gt; &lt;decimal-integer&gt;
                [&lt;SP&gt; R &lt;SP&gt; &lt;decimal-integer&gt;] &lt;CRLF&gt;
            REST &lt;SP&gt; &lt;marker&gt; &lt;CRLF&gt;
            RNFR &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            RNTO &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            ABOR &lt;CRLF&gt;
            DELE &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            RMD  &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            MKD  &lt;SP&gt; &lt;pathname&gt; &lt;CRLF&gt;
            PWD  &lt;CRLF&gt;
            LIST [&lt;SP&gt; &lt;pathname&gt;] &lt;CRLF&gt;
            NLST [&lt;SP&gt; &lt;pathname&gt;] &lt;CRLF&gt;
            SITE &lt;SP&gt; &lt;string&gt; &lt;CRLF&gt;
            SYST &lt;CRLF&gt;
            STAT [&lt;SP&gt; &lt;pathname&gt;] &lt;CRLF&gt;
            HELP [&lt;SP&gt; &lt;string&gt;] &lt;CRLF&gt;
            NOOP &lt;CRLF&gt;
            feat            = "Feat" CRLF
            opts            = opts-cmd SP command-name
                               [ SP command-options ] CRLF

</pre></div><p>


</p>
<a name="sec-5.3.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
FTP Command Arguments</h3>

<p>
         The syntax of the above argument fields (using BNF notation
         where applicable) is:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
FIXME UPDATE TO ABNF
           &lt;username&gt; ::= &lt;string&gt;
           &lt;password&gt; ::= &lt;string&gt;
           &lt;account-information&gt; ::= &lt;string&gt;
           &lt;string&gt; ::= &lt;char&gt; | &lt;char&gt;&lt;string&gt;
           &lt;char&gt; ::= any of the 128 ASCII characters except &lt;CR&gt; and
           &lt;LF&gt;
           &lt;marker&gt; ::= &lt;pr-string&gt;
           &lt;pr-string&gt; ::= &lt;pr-char&gt; | &lt;pr-char&gt;&lt;pr-string&gt;
           &lt;pr-char&gt; ::= printable characters, any
                         ASCII code 33 through 126
           &lt;byte-size&gt; ::= &lt;number&gt;
           &lt;host-port&gt; ::= &lt;host-number&gt;,&lt;port-number&gt;
           &lt;host-number&gt; ::= &lt;number&gt;,&lt;number&gt;,&lt;number&gt;,&lt;number&gt;
           &lt;port-number&gt; ::= &lt;number&gt;,&lt;number&gt;
           &lt;number&gt; ::= any decimal integer 1 through 255
           &lt;form-code&gt; ::= N | T | C
           &lt;type-code&gt; ::= A [&lt;sp&gt; &lt;form-code&gt;]
                         | E [&lt;sp&gt; &lt;form-code&gt;]
                         | I
                         | L &lt;sp&gt; &lt;byte-size&gt;
           &lt;structure-code&gt; ::= F | R | P
           &lt;mode-code&gt; ::= S | B | C
           &lt;pathname&gt; ::= &lt;string&gt;
           &lt;decimal-integer&gt; ::= any decimal integer
</pre></div><p>



</p>
<a name="sec-5.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Sequencing of Commands and Replies</h3>

<p>
      The communication between the user and server is intended to be an
      alternating dialogue.  As such, the user issues an FTP command and
      the server responds with a prompt primary reply.  The user should
      wait for this initial primary success or failure response before
      sending further commands.

</p>
<p>
      Certain commands require a second reply for which the user should
      also wait.  These replies may, for example, report on the progress
      or completion of file transfer or the closing of the data
      connection.  They are secondary replies to file transfer commands.

</p>
<p>
      One important group of informational replies is the connection
      greetings.  Under normal circumstances, a server will send a 220
      reply, &quot;awaiting input&quot;, when the connection is completed.  The
      user should wait for this greeting message before sending any
      commands.  If the server is unable to accept input right away, a
      120 &quot;expected delay&quot; reply should be sent immediately and a 220
      reply when ready.  The user will then know not to hang up if there
      is a delay.

</p>
<p>
</p>
<blockquote class="text"><dl>
<dt>Spontaneous Replies</dt>
<dd>
       
       <br />

         Sometimes &quot;the system&quot; spontaneously has a message to be sent
         to a user (usually all users).  For example, &quot;System going down
         in 15 minutes&quot;.  There is no provision in FTP for such
         spontaneous information to be sent from the server to the user.
         It is recommended that such information be queued in the
         server-PI and delivered to the user-PI in the next reply
         (possibly making it a multi-line reply).

</dd>
</dl></blockquote><p>

</p>
<p>
      The table below lists alternative success and failure replies for
      each command.  These MUST be strictly adhered to; a server MAY
      substitute text in the replies, but the meaning and action implied
      by the code numbers and by the specific command reply sequence
      cannot be altered.

</p>
<p>
</p>
<blockquote class="text"><dl>
<dt>Command-Reply Sequences</dt>
<dd>
       
       <br />

         In this section, the command-reply sequence is presented.  Each
         command is listed with its possible replies; command groups are
         listed together.  Preliminary replies are listed first (with
         their succeeding replies indented and under them), then
         positive and negative completion, and finally intermediary
         replies with the remaining commands from the sequence
         following.  This listing forms the basis for the state
         diagrams, which will be presented separately.

</dd>
</dl></blockquote><p>

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            Connection Establishment
               120
                  220
               220
               421
            Login
               USER
                  230
                  530
                  500, 501, 421
                  331, 332
               PASS
                  230
                  202
                  530
                  500, 501, 503, 421
                  332
               ACCT
                  230
                  202
                  530
                  500, 501, 503, 421
               CWD
                  250
                  500, 501, 502, 421, 530, 550
               CDUP
                  200
                  500, 501, 502, 421, 530, 550
               SMNT
                  202, 250
                  500, 501, 502, 421, 530, 550
            Logout
               REIN
                  120
                     220
                  220
                  421
                  500, 502
               QUIT
                  221
                  500

            Transfer parameters
               PORT
                  200
                  500, 501, 421, 530
               PASV
                  227
                  500, 501, 502, 421, 530
               MODE
                  200
                  500, 501, 504, 421, 530
               TYPE
                  200
                  500, 501, 504, 421, 530
               STRU
                  200
                  500, 501, 504, 421, 530
            File action commands
               ALLO
                  200
                  202
                  500, 501, 504, 421, 530
               REST
                  500, 501, 502, 421, 530
                  350
               STOR
                  125, 150
                     (110)
                     226, 250
                     425, 426, 451, 551, 552
                  532, 450, 452, 553
                  500, 501, 421, 530
               STOU
                  125, 150
                     (110)
                     226, 250
                     425, 426, 451, 551, 552
                  532, 450, 452, 553
                  500, 501, 421, 530
               RETR
                  125, 150
                     (110)
                     226, 250
                     425, 426, 451
                  450, 550
                  500, 501, 421, 530

               LIST
                  125, 150
                     226, 250
                     425, 426, 451
                  450
                  500, 501, 502, 421, 530
               NLST
                  125, 150
                     226, 250
                     425, 426, 451
                  450
                  500, 501, 502, 421, 530
               APPE
                  125, 150
                     (110)
                     226, 250
                     425, 426, 451, 551, 552
                  532, 450, 550, 452, 553
                  500, 501, 502, 421, 530
               RNFR
                  450, 550
                  500, 501, 502, 421, 530
                  350
               RNTO
                  250
                  532, 553
                  500, 501, 502, 503, 421, 530
               DELE
                  250
                  450, 550
                  500, 501, 502, 421, 530
               RMD
                  250
                  500, 501, 502, 421, 530, 550
               MKD
                  257
                  500, 501, 502, 421, 530, 550
               PWD
                  257
                  500, 501, 502, 421, 550
               ABOR
                  225, 226
                  500, 501, 502, 421

            Informational commands
               SYST
                  215
                  500, 501, 502, 421
               STAT
                  211, 212, 213
                  450
                  500, 501, 502, 421, 530
               HELP
                  211, 214
                  500, 501, 502, 421
            Miscellaneous commands
               SITE
                  200
                  202
                  500, 501, 530
               NOOP
                  200
                  500 421
</pre></div><p>


</p>
<a name="sec-6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
State Diagrams</h3>

<p>
   Here we present state diagrams for a very simple minded FTP
   implementation.  Only the first digit of the reply codes is used.
   There is one state diagram for each group of FTP commands or command
   sequences.

</p>
<p>
   The command groupings were determined by constructing a model for
   each command then collecting together the commands with structurally
   identical models.

</p>
<p>
   For each command or command sequence there are three possible
   outcomes: success (S), failure (F), and error (E).  In the state
   diagrams below we use the symbol B for &quot;begin&quot;, and the symbol W for
   &quot;wait for reply&quot;.

</p>
<p>
   We first present the diagram that represents the largest group of FTP
   commands:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                               1,3    +---+
                          -----------&gt;| E |
                         |            +---+
                         |
      +---+    cmd    +---+    2      +---+
      | B |----------&gt;| W |----------&gt;| S |
      +---+           +---+           +---+
                         |
                         |     4,5    +---+
                          -----------&gt;| F |
                                      +---+
</pre></div><p>

      

</p>
<p>
      This diagram models the commands:

</p>
<p>
</p>
<blockquote class="text">
<p>
         ABOR, ALLO, DELE, CWD, CDUP, SMNT, HELP, MODE, NOOP, PASV,
         QUIT, SITE, PORT, SYST, STAT, RMD, MKD, PWD, STRU, and TYPE.

</p>
</blockquote><p>

</p>
<p>


</p>
<p>
   The other large group of commands is represented by a very similar
   diagram:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                               3      +---+
                          -----------&gt;| E |
                         |            +---+
                         |
      +---+    cmd    +---+    2      +---+
      | B |----------&gt;| W |----------&gt;| S |
      +---+       ---&gt;+---+           +---+
                 |     | |
                 |     | |     4,5    +---+
                 |  1  |  -----------&gt;| F |
                  -----               +---+
</pre></div><p>

      

</p>
<p>
      This diagram models the commands:

</p>
<p>
</p>
<blockquote class="text">
<p>
         APPE, LIST, NLST, REIN, RETR, STOR, and STOU.

</p>
</blockquote><p>

</p>
<p>
   Note that this second model could also be used to represent the first
   group of commands, the only difference being that in the first group
   the 100 series replies are unexpected and therefore treated as error,
   while the second group expects (some MAY require) 100 series replies.
   Remember that at most, one 100 series reply is allowed per command.

</p>
<p>
   The remaining diagrams model command sequences, perhaps the simplest
   of these is the rename sequence:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      +---+   RNFR    +---+    1,2    +---+
      | B |----------&gt;| W |----------&gt;| E |
      +---+           +---+        --&gt;+---+
                       | |        |
                3      | | 4,5    |
         --------------  ------   |
        |                      |  |   +---+
        |               -------------&gt;| S |
        |              |   1,3 |  |   +---+
        |             2|  --------
        |              | |     |
        V              | |     |
      +---+   RNTO    +---+ 4,5 -----&gt;+---+
      |   |----------&gt;| W |----------&gt;| F |
      +---+           +---+           +---+
</pre></div><p>

      

</p>
<p>


</p>
<p>
   The next diagram is a simple model of the Restart command:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      +---+   REST    +---+    1,2    +---+
      | B |----------&gt;| W |----------&gt;| E |
      +---+           +---+        --&gt;+---+
                       | |        |
                3      | | 4,5    |
         --------------  ------   |
        |                      |  |   +---+
        |               -------------&gt;| S |
        |              |   3   |  |   +---+
        |             2|  --------
        |              | |     |
        V              | |     |
      +---+   cmd     +---+ 4,5 -----&gt;+---+
      |   |----------&gt;| W |----------&gt;| F |
      +---+        --&gt;+---+           +---+
                  |      |
                  |  1   |
                   ------
</pre></div><p>
  

</p>
<p>
         Where &quot;cmd&quot; is APPE, STOR, or RETR.

</p>
<p>
   We note that the above three models are similar.  The Restart differs
   from the Rename two only in the treatment of 100 series replies at
   the second stage, while the second group expects (some MAY require)
   100 series replies.  Remember that at most, one 100 series reply is
   allowed per command.

</p>
<p>


</p>
<p>
   The most complicated diagram is for the Login sequence:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                            1
      +---+   USER    +---+-------------&gt;+---+
      | B |----------&gt;| W | 2       ----&gt;| E |
      +---+           +---+------  |  --&gt;+---+
                       | |       | | |
                     3 | | 4,5   | | |
         --------------   -----  | | |
        |                      | | | |
        |                      | | | |
        |                 ---------  |
        |               1|     | |   |
        V                |     | |   |
      +---+   PASS    +---+ 2  |  ------&gt;+---+
      |   |----------&gt;| W |-------------&gt;| S |
      +---+           +---+   ----------&gt;+---+
                       | |   | |     |
                     3 | |4,5| |     |
         --------------   --------   |
        |                    | |  |  |
        |                    | |  |  |
        |                 -----------
        |             1,3|   | |  |
        V                |  2| |  |
      +---+   ACCT    +---+--  |   -----&gt;+---+
      |   |----------&gt;| W | 4,5 --------&gt;| F |
      +---+           +---+-------------&gt;+---+
</pre></div><p>


</p>
<p>


</p>
<p>
   Finally, we present a generalized diagram that could be used to model
   the command and reply interchange:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

               ------------------------------------
              |                                    |
      Begin   |                                    |
        |     V                                    |
        |   +---+  cmd   +---+ 2         +---+     |
         --&gt;|   |-------&gt;|   |----------&gt;|   |     |
            |   |        | W |           | S |-----|
         --&gt;|   |     --&gt;|   |-----      |   |     |
        |   +---+    |   +---+ 4,5 |     +---+     |
        |     |      |    | |      |               |
        |     |      |   1| |3     |     +---+     |
        |     |      |    | |      |     |   |     |
        |     |       ----  |       ----&gt;| F |-----
        |     |             |            |   |
        |     |             |            +---+
         -------------------
              |
              |
              V
             End
</pre></div><p>

      

</p>
<a name="sec-7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Typical FTP Scenario</h3>

<p>
   User at host U wanting to transfer files to/from host S:

</p>
<p>
   In general, the user will communicate to the server via a mediating
   user-FTP process.  The following may be a typical scenario.  The
   user-FTP prompts are shown in parentheses, '----&gt;' represents
   commands from host U to host S, and '&lt;----' represents replies from
   host S to host U.

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   LOCAL COMMANDS BY USER              ACTION INVOLVED

   ftp (host) multics&lt;CR&gt;         Connect to host S, port L,
                                  establishing control connections.
                                  &lt;---- 220 Service ready &lt;CRLF&gt;.
   username Doe &lt;CR&gt;              USER Doe&lt;CRLF&gt;----&gt;
                                  &lt;---- 331 User name ok,
                                            need password&lt;CRLF&gt;.
   password mumble &lt;CR&gt;           PASS mumble&lt;CRLF&gt;----&gt;
                                  &lt;---- 230 User logged in&lt;CRLF&gt;.
   retrieve (local type) ASCII&lt;CR&gt;
   (local pathname) test 1 &lt;CR&gt;   User-FTP opens local file in ASCII.
   (for. pathname) test.pl1&lt;CR&gt;   RETR test.pl1&lt;CRLF&gt; ----&gt;
                                  &lt;---- 150 File status okay;
                                        about to open data
                                        connection&lt;CRLF&gt;.
                                  Server makes data connection
                                  to port U.

                                  &lt;---- 226 Closing data connection,
                                      file transfer successful&lt;CRLF&gt;.
   type Image&lt;CR&gt;                 TYPE I&lt;CRLF&gt; ----&gt;
                                  &lt;---- 200 Command OK&lt;CRLF&gt;
   store (local type) image&lt;CR&gt;
   (local pathname) file dump&lt;CR&gt; User-FTP opens local file in Image.
   (for.pathname) &gt;udd&gt;cn&gt;fd&lt;CR&gt;  STOR &gt;udd&gt;cn&gt;fd&lt;CRLF&gt; ----&gt;
                                  &lt;---- 550 Access denied&lt;CRLF&gt;
   terminate                      QUIT &lt;CRLF&gt; ----&gt;
                                  Server closes all
                                  connections.
</pre></div><p>


</p>
<a name="sec-8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Connection Establishment</h3>

<p>
   The FTP control connection is established via TCP between the user
   process port U and the server process port L.  This protocol is
   assigned the service port 21 (25 octal), that is L=21.

</p>
<a name="sec-9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="sec-10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<a name="sec=10.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Privacy and Passwords with Clear Text Protocols</h3>

<p>
   All data and control information (including passwords) is sent across
   the network in unencrypted form by standard FTP <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>.  To guarantee
   the privacy of the information FTP transmits, a strong encryption
   scheme should be used whenever possible.  One such mechanism is
   defined in <a class='info' href='#RFC2228'>[RFC2228]<span> (</span><span class='info'>Horowitz, M., &ldquo;FTP Security Extensions,&rdquo; October&nbsp;1997.</span><span>)</span></a>.

</p>
<p>
   Standard FTP <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> sends passwords in clear text using the &quot;PASS&quot;
   command.  It is suggested that FTP clients and servers use alternate
   authentication mechanisms that are not subject to eavesdropping (such
   as the mechanisms being developed by the IETF Common Authentication
   Technology Working Group <a class='info' href='#RFC2228'>[RFC2228]<span> (</span><span class='info'>Horowitz, M., &ldquo;FTP Security Extensions,&rdquo; October&nbsp;1997.</span><span>)</span></a>).

</p>
<a name="sec-10.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Securing FTP with TLS</h3>

<p>
   <a class='info' href='#RFC4217'>[RFC4217]<span> (</span><span class='info'>Ford-Hutchinson, P., &ldquo;Securing FTP with TLS,&rdquo; October&nbsp;2005.</span><span>)</span></a> describes a mechanism that can be used by FTP clients
   and servers to implement security and authentication using the TLS
   protocol defined by RFC 2246, "The TLS Protocol Version 1.0.", and
   the extensions to the FTP protocol defined by <a class='info' href='#RFC2228'>[RFC2228]<span> (</span><span class='info'>Horowitz, M., &ldquo;FTP Security Extensions,&rdquo; October&nbsp;1997.</span><span>)</span></a>, "FTP Security
   Extensions".  It describes the subset of the extensions that are
   required and the parameters to be used, discusses some of the policy
   issues that clients and servers will need to take, considers some of
   the implications of those policies, and discusses some expected
   behaviours of implementations to allow interoperation.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
The Bounce Attack</h3>

<p>
   The version of FTP specified in the standard <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> provides a method
   for attacking well known network servers, while making the
   perpetrators difficult to track down.  The attack involves sending an
   FTP &quot;PORT&quot; command to an FTP server containing the network address
   and the port number of the machine and service being attacked.  At
   this point, the original client can instruct the FTP server to send a
   file to the service being attacked.  Such a file would contain
   commands relevant to the service being attacked (SMTP, NNTP, etc.).
   Instructing a third party to connect to the service, rather than
   connecting directly, makes tracking down the perpetrator difficult
   and can circumvent network-address-based access restrictions.

</p>
<p>
   As an example, a client uploads a file containing SMTP commands to an
   FTP server.  Then, using an appropriate PORT command, the client
   instructs the server to open a connection to a third machine's SMTP
   port.  Finally, the client instructs the server to transfer the
   uploaded file containing SMTP commands to the third machine.  This
   may allow the client to forge mail on the third machine without
   making a direct connection.  This makes it difficult to track
   attackers.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3.1"></a><h3>10.3.1.&nbsp;
Protecting Against the Bounce Attack</h3>

<p>
   The original FTP specification <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> assumes that data connections
   will be made using the Transmission Control Protocol (TCP) <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>.
   TCP port numbers in the range 0 - 1023 are reserved for well known
   services such as mail, network news and FTP control connections
   (See IANA "Port Numbers" Registry at http://www.iana.org/assignments/port-numbers ).  The FTP specification makes no restrictions on the TCP port
   number used for the data connection.  Therefore, using proxy FTP,
   clients have the ability to tell the server to attack a well known
   service on any machine.

</p>
<p>
   To avoid such bounce attacks, it is suggested that servers not open
   data connections to TCP ports less than 1024.  If a server receives a
   PORT command containing a TCP port number less than 1024, the
   suggested response is 504 (defined as &quot;Command not implemented for
   that parameter&quot; by <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>).  Note that this still leaves non-well
   known servers (those running on ports greater than 1023) vulnerable
   to bounce attacks.

</p>
<p>
   <a class='info' href='#sec-4.1.2.1'>Section&nbsp;4.1.2.1<span> (</span><span class='info'>Extensions for IPv6 and NATs: Extended Port (EPRT) and Extended Passive Mode (EPSV)</span><span>)</span></a> and <a class='info' href='#RFC1639'>[RFC1639]<span> (</span><span class='info'>Piscitello, D., &ldquo;FTP Operation Over Big Address Records (FOOBAR),&rdquo; June&nbsp;1994.</span><span>)</span></a> (now obsolete) provide a mechanism
   that would allow data connections to be made using a transport
   protocol other than TCP.  Similar precautions should be taken to
   protect well known services when using these protocols.

</p>
<p>
   Also note that the bounce attack generally requires that a
   perpetrator be able to upload a file to an FTP server and later
   download it to the service being attacked.  Using proper file
   protections will prevent this behavior.  However, attackers can also
   attack services by sending random data from a remote FTP server which
   may cause problems for some services.

</p>
<p>
   Disabling the PORT command is also an option for protecting against
   the bounce attack.  Most file transfers can be made using only the
   PASV command [Bel94].  The disadvantage of disabling the PORT command
   is that one loses the ability to use proxy FTP, but proxy FTP may not
   be necessary in a particular environment.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.4"></a><h3>10.4.&nbsp;
Restricted Access</h3>

<p>
   For some FTP servers, it is desirable to restrict access based on
   network address.  For example, a server might want to restrict access
   to certain files from certain places (e.g., a certain file should not
   be transferred out of an organization).  In such a situation, the
   server should confirm that the network address of the remote hosts on
   both the control connection and the data connection are within the
   organization before sending a restricted file.  By checking both
   connections, a server is protected against the case when the control
   connection is established with a trusted host and the data connection
   is not.  Likewise, the client should verify the IP address of the
   remote host after accepting a connection on a port opened in listen
   mode to verify that the connection was made by the expected server.

</p>
<p>
   Note that restricting access based on network address leaves the FTP
   server vulnerable to &quot;spoof&quot; attacks.  In a spoof attack, for
   example, an attacking machine could assume the host address of
   another machine inside an organization and download files that are
   not accessible from outside the organization.  Whenever possible,
   secure authentication mechanisms should be used, such as those
   outlined in <a class='info' href='#RFC2228'>[RFC2228]<span> (</span><span class='info'>Horowitz, M., &ldquo;FTP Security Extensions,&rdquo; October&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.5"></a><h3>10.5.&nbsp;
Protecting Passwords Against Brute Force Attacks</h3>

<p>
   To minimize the risk of brute force password guessing through the FTP
   server, it is suggested that servers limit the number of attempts
   that can be made at sending a correct password.  After a small number
   of attempts (3-5), the server should close the control connection
   with the client.  Before closing the control connection the server
   must send a return code of 421 (&quot;Service not available, closing
   control connection.&quot; <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>) to the client.  In addition, it is
   suggested that the server impose a 5 second delay before replying to
   an invalid &quot;PASS&quot; command to diminish the efficiency of a brute force
   attack.  If available, mechanisms already provided by the target
   operating system should be used to implement the above suggestions.

</p>
<p>
   An intruder can subvert the above mechanisms by establishing
   multiple, parallel control connections to a server.  To combat the
   use of multiple concurrent connections, the server could either limit
   the total number of control connections possible or attempt to detect
   suspicious activity across sessions and refuse further connections
   from the site.  However, both of these mechanisms open the door to
   &quot;denial of service&quot; attacks, in which an attacker purposely initiates
   the attack to disable access by a valid user.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.6"></a><h3>10.6.&nbsp;
Protecting Usernames</h3>

<p>
   Standard FTP <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> specifies a 530 response to the USER command when
   the username is rejected.  If the username is valid and a password is
   required FTP returns a 331 response instead.  In order to prevent a
   malicious client from determining valid usernames on a server, it is
   suggested that a server always return 331 to the USER command and
   then reject the combination of username and password for an invalid
   username.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.7"></a><h3>10.7.&nbsp;
Port Stealing</h3>

<p>
   Many operating systems assign dynamic port numbers in increasing
   order.  By making a legitimate transfer, an attacker can observe the
   current port number allocated by the server and &quot;guess&quot; the next one
   that will be used.  The attacker can make a connection to this port,
   thus denying another legitimate client the ability to make a
   transfer.  Alternatively, the attacker can steal a file meant for a
   legitimate user.  In addition, an attacker can insert a forged file
   into a data stream thought to come from an authenticated client.
   This problem can be mitigated by making FTP clients and servers use
   random local port numbers for data connections, either by requesting
   random ports from the operating system or using system dependent
   mechanisms.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.8"></a><h3>10.8.&nbsp;
Software-Base Security Problems</h3>

<p>
   The emphasis in this document is on protocol-related security issues.
   There are a number of documented FTP security-related problems that
   are due to poor implementation as well.  Although the details of
   these types of problems are beyond the scope of this document, it
   should be pointed out that the following FTP features have been abused
   in the past and should be treated with great care by future
   implementers:

</p>
<p>Anonymous FTP
</p>
<blockquote class="text">
<p>
      Anonymous FTP refers to the ability of a client to connect to an
      FTP server with minimal authentication and gain access to public
      files.  Security problems arise when such a user can read all
      files on the system or can create files. [CERT92:09] [CERT93:06]

</p>
</blockquote>

<p>Remote Command Execution
</p>
<blockquote class="text">
<p>
      An optional FTP extension, &quot;SITE EXEC&quot;, allows clients to execute
      arbitrary commands on the server.  This feature should obviously
      be implemented with great care.  There are several documented
      cases of the FTP &quot;SITE EXEC&quot; command being used to subvert server
      security [CERT94:08] [CERT95:16]

</p>
</blockquote>

<p>
Debug Code
</p>
<blockquote class="text">
<p>
      Several previous security compromises related to FTP can be
      attributed to software that was installed with debugging features
      enabled [CERT88:01].

</p>
</blockquote>

<p>
   This document recommends that implementors of FTP servers with these
   capabilities review all of the CERT advisories for attacks on these
   or similar mechanisms before releasing their software.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.9"></a><h3>10.9.&nbsp;
Server Capabilities Exposed by FEAT</h3>

<p>
   No significant new security issues, not already present in the FTP
   protocol, are believed to have been created by this extension.
   However, this extension does provide a mechanism by which users can
   determine the capabilities of an FTP server, and from which
   additional information may be able to be deduced.  While the same
   basic information could be obtained by probing the server for the
   various commands, if the FEAT command were not provided, that method
   may reveal an attacker by logging the attempts to access various
   extension commands.  This possibility is not considered a serious
   enough threat to be worthy of any remedial action.

</p>
<p>
   The security of any additional features that might be reported by the
   FEAT command, and manipulated by the OPTS command, should be
   addressed where those features are defined.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IPTW">[IPTW]</a></td>
<td class="author-text">Feinler, E., &ldquo;Internet Protocol Transition Workbook,&rdquo; &nbsp;, March&nbsp;1982.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0791">[RFC0791]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0854">[RFC0854]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc854">Telnet Protocol Specification</a>,&rdquo; STD&nbsp;8, RFC&nbsp;854, May&nbsp;1983 (<a href="http://www.rfc-editor.org/rfc/rfc854.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0959">[RFC0959]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc959">File Transfer Protocol</a>,&rdquo; STD&nbsp;9, RFC&nbsp;959, October&nbsp;1985 (<a href="http://www.rfc-editor.org/rfc/rfc959.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2228">[RFC2228]</a></td>
<td class="author-text"><a href="mailto:marc@cygnus.com">Horowitz, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2228">FTP Security Extensions</a>,&rdquo; RFC&nbsp;2228, October&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2228.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2228.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2228.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2640">[RFC2640]</a></td>
<td class="author-text"><a href="mailto:curtinw@ftm.disa.mil">Curtin, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2640">Internationalization of the File Transfer Protocol</a>,&rdquo; RFC&nbsp;2640, July&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2640.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3659">[RFC3659]</a></td>
<td class="author-text">Hethmon, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3659">Extensions to FTP</a>,&rdquo; RFC&nbsp;3659, March&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc3659.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4217">[RFC4217]</a></td>
<td class="author-text">Ford-Hutchinson, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4217">Securing FTP with TLS</a>,&rdquo; RFC&nbsp;4217, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4217.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1639">[RFC1639]</a></td>
<td class="author-text"><a href="mailto:dave@corecom.com">Piscitello, D.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1639">FTP Operation Over Big Address Records (FOOBAR)</a>,&rdquo; RFC&nbsp;1639, June&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1639.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2389">[RFC2389]</a></td>
<td class="author-text"><a href="mailto:phethmon@hethmon.com">Hethmon, P.</a> and <a href="mailto:kre@munnari.OZ.AU">R. Elz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2389">Feature negotiation mechanism for the File Transfer Protocol</a>,&rdquo; RFC&nbsp;2389, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2389.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2389.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2389.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2428">[RFC2428]</a></td>
<td class="author-text"><a href="mailto:mallman@lerc.nasa.gov">Allman, M.</a>, <a href="mailto:ostermann@cs.ohiou.edu">Ostermann, S.</a>, and <a href="mailto:cmetz@inner.net">C. Metz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2428">FTP Extensions for IPv6 and NATs</a>,&rdquo; RFC&nbsp;2428, September&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2428.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2428.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2428.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2577">[RFC2577]</a></td>
<td class="author-text"><a href="mailto:mallman@grc.nasa.gov">Allman, M.</a> and <a href="mailto:ostermann@cs.ohiou.edu">S. Ostermann</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2577">FTP Security Considerations</a>,&rdquo; RFC&nbsp;2577, May&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2577.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5797">[RFC5797]</a></td>
<td class="author-text">Klensin, J. and A. Hoenes, &ldquo;<a href="http://tools.ietf.org/html/rfc5797">FTP Command and Extension Registry</a>,&rdquo; RFC&nbsp;5797, March&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5797.txt">TXT</a>).</td></tr>
</table>

<a name="Appendix-A"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Page Structure</h3>

<p>
   The need for FTP to support page structure derives principally from
   the  need to support efficient transmission of files between TOPS-20
   systems, particularly the files used by NLS.

</p>
<p>
   The file system of TOPS-20 is based on the concept of pages.  The
   operating system is most efficient at manipulating files as pages.
   The operating system provides an interface to the file system so that
   many applications view files as sequential streams of characters.
   However, a few applications use the underlying page structures
   directly, and some of these create holey files.

</p>
<p>
   A TOPS-20 disk file consists of four things: a pathname, a page
   table, a (possibly empty) set of pages, and a set of attributes.

</p>
<p>
   The pathname is specified in the RETR or STOR command.  It includes
   the directory name, file name, file name extension, and generation
   number.

</p>
<p>
   The page table contains up to 2**18 entries.  Each entry may be
   EMPTY, or may point to a page.  If it is not empty, there are also
   some page-specific access bits; not all pages of a file need have the
   same access protection.

</p>
<p>
      A page is a contiguous set of 512 words of 36 bits each.

</p>
<p>
   The attributes of the file, in the File Descriptor Block (FDB),
   contain such things as creation time, write time, read time, writer's
   byte-size, end-of-file pointer, count of reads and writes, backup
   system tape numbers, etc.

</p>
<p>
   Note that there is NO requirement that entries in the page table be
   contiguous.  There may be empty page table slots between occupied
   ones.  Also, the end of file pointer is simply a number.  There is no
   requirement that it in fact point at the &quot;last&quot; datum in the file.
   Ordinary sequential I/O calls in TOPS-20 will cause the end of file
   pointer to be left after the last datum written, but other operations
   may cause it not to be so, if a particular programming system so
   requires.

</p>
<p>
   In fact, in both of these special cases, &quot;holey&quot; files and
   end-of-file pointers NOT at the end of the file, occur with NLS data
   files.

</p>
<p>


</p>
<p>
   The TOPS-20 paged files can be sent with the FTP transfer parameters:
   TYPE L 36, STRU P, and MODE S (in fact, any mode could be used).

</p>
<p>
   Each page of information has a header.  Each header field, which is a
   logical byte, is a TOPS-20 word, since the TYPE is L 36.

</p>
<p>
   The header fields are:

</p>
<p>
      Word 0: Header Length.

</p>
<p>
         The header length is 5.

</p>
<p>
      Word 1: Page Index.

</p>
<p>
         If the data is a disk file page, this is the number of that
         page in the file's page map.  Empty pages (holes) in the file
         are simply not sent.  Note that a hole is NOT the same as a
         page of zeros.

</p>
<p>
      Word 2: Data Length.

</p>
<p>
         The number of data words in this page, following the header.
         Thus, the total length of the transmission unit is the Header
         Length plus the Data Length.

</p>
<p>
      Word 3: Page Type.

</p>
<p>
         A code for what type of chunk this is.  A data page is type 3,
         the FDB page is type 2.

</p>
<p>
      Word 4: Page Access Control.

</p>
<p>
         The access bits associated with the page in the file's page
         map.  (This full word quantity is put into AC2 of an SPACS by
         the program reading from net to disk.)

</p>
<p>
   After the header are Data Length data words.  Data Length is
   currently either 512 for a data page or 31 for an FDB.  Trailing
   zeros in a disk file page may be discarded, making Data Length less
   than 512 in that case.

</p>
<a name="Appendix-B"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Directory Commands</h3>

<p>
   Since UNIX has a tree-like directory structure in which directories
   are as easy to manipulate as ordinary files, it is useful to expand
   the FTP servers on these machines to include commands which deal with
   the creation of directories.  Since there are other hosts on the
   ARPA-Internet which have tree-like directories (including TOPS-20 and
   Multics), these commands are as general as possible.

</p>
<p>
      Four directory commands have been added to FTP:

</p>
<p>
         MKD pathname

</p>
<p>
            Make a directory with the name &quot;pathname&quot;.

</p>
<p>
         RMD pathname

</p>
<p>
            Remove the directory with the name &quot;pathname&quot;.

</p>
<p>
         PWD

</p>
<p>
            Print the current working directory name.

</p>
<p>
         CDUP

</p>
<p>
            Change to the parent of the current working directory.

</p>
<p>
   The  &quot;pathname&quot;  argument should be created (removed) as a
   subdirectory of the current working directory, unless the &quot;pathname&quot;
   string contains sufficient information to specify otherwise to the
   server, e.g., &quot;pathname&quot; is an absolute pathname (in UNIX and
   Multics), or pathname is something like &quot;&lt;abso.lute.path&gt;&quot; to
   TOPS-20.

</p>
<p>
   REPLY CODES

</p>
<p>
      The CDUP command is a special case of CWD, and is included to
      simplify the implementation of programs for transferring directory
      trees between operating systems having different syntaxes for
      naming the parent directory.  The reply codes for CDUP be
      identical to the reply codes of CWD.

</p>
<p>
      The reply codes for RMD be identical to the reply codes for its
      file analogue, DELE.

</p>
<p>
      The reply codes for MKD, however, are a bit more complicated.  A
      freshly created directory will probably be the object of a future

</p>
<p>


</p>
<p>
      CWD command.  Unfortunately, the argument to MKD may not always be
      a suitable argument for CWD.  This is the case, for example, when
      a TOPS-20 subdirectory is created by giving just the subdirectory
      name.  That is, with a TOPS-20 server FTP, the command sequence

</p>
<p>
         MKD MYDIR
         CWD MYDIR

</p>
<p>
      will fail.  The new directory may only be referred to by its
      &quot;absolute&quot; name; e.g., if the MKD command above were issued while
      connected to the directory &lt;DFRANKLIN&gt;, the new subdirectory
      could only be referred to by the name &lt;DFRANKLIN.MYDIR&gt;.

</p>
<p>
      Even on UNIX and Multics, however, the argument given to MKD may
      not be suitable.  If it is a &quot;relative&quot; pathname (i.e., a pathname
      which is interpreted relative to the current directory), the user
      would need to be in the same current directory in order to reach
      the subdirectory.  Depending on the application, this may be
      inconvenient.  It is not very robust in any case.

</p>
<p>
      To solve these problems, upon successful completion of an MKD
      command, the server should return a line of the form:

</p>
<p>
         257&lt;space&gt;&quot;&lt;directory-name&gt;&quot;&lt;space&gt;&lt;commentary&gt;

</p>
<p>
      That is, the server will tell the user what string to use when
      referring to the created  directory.  The directory name can
      contain any character; embedded double-quotes should be escaped by
      double-quotes (the &quot;quote-doubling&quot; convention).

</p>
<p>
      For example, a user connects to the directory /usr/dm, and creates
      a subdirectory, named pathname:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         CWD /usr/dm
         200 directory changed to /usr/dm
         MKD pathname
         257 "/usr/dm/pathname" directory created
</pre></div><p>
		 

</p>
<p>
      An example with an embedded double quote:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         MKD foo"bar
         257 "/usr/dm/foo""bar" directory created
         CWD /usr/dm/foo"bar
         200 directory changed to /usr/dm/foo"bar
</pre></div><p>


</p>
<p>


</p>
<p>
      The prior existence of a subdirectory with the same name is an
      error, and the server must return an &quot;access denied&quot; error reply
      in that case.

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         CWD /usr/dm
         200 directory changed to /usr/dm
         MKD pathname
         521-"/usr/dm/pathname" directory already exists;
         521 taking no action.
</pre></div><p>


</p>
<p>
      The failure replies for MKD are analogous to its file  creating
      cousin, STOR.  Also, an &quot;access denied&quot; return is given if a file
      name with the same name as the subdirectory will conflict with the
      creation of the subdirectory (this is a problem on UNIX, but
      shouldn't be one on TOPS-20).

</p>
<p>
      Essentially because the PWD command returns the same type of
      information as the successful MKD command, the successful PWD
      command uses the 257 reply code as well.

</p>
<p>
   SUBTLETIES

</p>
<p>
      Because these commands will be most useful in transferring
      subtrees from one machine to another, carefully observe that the
      argument to MKD is to be interpreted as a sub-directory of  the
      current working directory, unless it contains enough information
      for the destination host to tell otherwise.  A hypothetical
      example of its use in the TOPS-20 world:

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         CWD &lt;some.where&gt;
         200 Working directory changed
         MKD overrainbow
         257 "&lt;some.where.overrainbow&gt;" directory created
         CWD overrainbow
         431 No such directory
         CWD &lt;some.where.overrainbow&gt;
         200 Working directory changed
</pre></div><p>


</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         CWD &lt;some.where&gt;
         200 Working directory changed to &lt;some.where&gt;
         MKD &lt;unambiguous&gt;
         257 "&lt;unambiguous&gt;" directory created
         CWD &lt;unambiguous&gt;
</pre></div><p>


</p>
<p>
      Note that the first example results in a subdirectory of the
      connected directory.  In contrast, the argument in the second
      example contains enough information for TOPS-20 to tell that  the

</p>
<p>


</p>
<p>
      &lt;unambiguous&gt; directory is a top-level directory.  Note also that
      in the first example the user &quot;violated&quot; the protocol by
      attempting to access the freshly created directory with a name
      other than the one returned by TOPS-20.  Problems could have
      resulted in this case had there been an &lt;overrainbow&gt; directory;
      this is an ambiguity inherent in some TOPS-20 implementations.
      Similar considerations apply to the RMD command.  The point is
      this: except where to do so would violate a host's conventions for
      denoting relative versus absolute pathnames, the host should treat
      the operands of the MKD and RMD commands as subdirectories.  The
      257 reply to the MKD command must always contain the absolute
      pathname of the created directory.

</p>
<a name="Appendix-C"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
RFCs on FTP</h3>

<p>
   Bhushan, Abhay, &quot;A File Transfer Protocol&quot;, RFC 114 (NIC 5823),
   MIT-Project MAC, 16 April 1971.

</p>
<p>
   Harslem, Eric, and John Heafner, &quot;Comments on RFC 114 (A File
   Transfer Protocol)&quot;, RFC 141 (NIC 6726), RAND, 29 April 1971.

</p>
<p>
   Bhushan, Abhay, et al, &quot;The File Transfer Protocol&quot;, RFC 172
   (NIC 6794), MIT-Project MAC, 23 June 1971.

</p>
<p>
   Braden, Bob, &quot;Comments on DTP and FTP Proposals&quot;, RFC 238 (NIC 7663),
   UCLA/CCN, 29 September 1971.

</p>
<p>
   Bhushan, Abhay, et al, &quot;The File Transfer Protocol&quot;, RFC 265
   (NIC 7813), MIT-Project MAC, 17 November 1971.

</p>
<p>
   McKenzie, Alex, &quot;A Suggested Addition to File Transfer Protocol&quot;,
   RFC 281 (NIC 8163), BBN, 8 December 1971.

</p>
<p>
   Bhushan, Abhay, &quot;The Use of &quot;Set Data Type&quot; Transaction in File
   Transfer Protocol&quot;, RFC 294 (NIC 8304), MIT-Project MAC,
   25 January 1972.

</p>
<p>
   Bhushan, Abhay, &quot;The File Transfer Protocol&quot;, RFC 354 (NIC 10596),
   MIT-Project MAC, 8 July 1972.

</p>
<p>
   Bhushan, Abhay, &quot;Comments on the File Transfer Protocol (RFC 354)&quot;,
   RFC 385 (NIC 11357), MIT-Project MAC, 18 August 1972.

</p>
<p>
   Hicks, Greg, &quot;User FTP Documentation&quot;, RFC 412 (NIC 12404), Utah,
   27 November 1972.

</p>
<p>
   Bhushan, Abhay, &quot;File Transfer Protocol (FTP) Status and Further
   Comments&quot;, RFC 414 (NIC 12406), MIT-Project MAC, 20 November 1972.

</p>
<p>
   Braden, Bob, &quot;Comments on File Transfer Protocol&quot;, RFC 430
   (NIC 13299), UCLA/CCN, 7 February 1973.

</p>
<p>
   Thomas, Bob, and Bob Clements, &quot;FTP Server-Server Interaction&quot;,
   RFC 438 (NIC 13770), BBN, 15 January 1973.

</p>
<p>
   Braden, Bob, &quot;Print Files in FTP&quot;, RFC 448 (NIC 13299), UCLA/CCN,
   27 February 1973.

</p>
<p>
   McKenzie, Alex, &quot;File Transfer Protocol&quot;, RFC 454 (NIC 14333), BBN,
   16 February 1973.

</p>
<p>
   Bressler, Bob, and Bob Thomas, &quot;Mail Retrieval via FTP&quot;, RFC 458
   (NIC 14378), BBN-NET and BBN-TENEX, 20 February 1973.

</p>
<p>
   Neigus, Nancy, &quot;File Transfer Protocol&quot;, RFC 542 (NIC 17759), BBN,
   12 July 1973.

</p>
<p>
   Krilanovich, Mark, and George Gregg, &quot;Comments on the File Transfer
   Protocol&quot;, RFC 607 (NIC 21255), UCSB, 7 January 1974.

</p>
<p>
   Pogran, Ken, and Nancy Neigus, &quot;Response to RFC 607 - Comments on the
   File Transfer Protocol&quot;, RFC 614 (NIC 21530), BBN, 28 January 1974.

</p>
<p>
   Krilanovich, Mark, George Gregg, Wayne Hathaway, and Jim White,
   &quot;Comments on the File Transfer Protocol&quot;, RFC 624 (NIC 22054), UCSB,
   Ames Research Center, SRI-ARC, 28 February 1974.

</p>
<p>
   Bhushan, Abhay, &quot;FTP Comments and Response to RFC 430&quot;, RFC 463
   (NIC 14573), MIT-DMCG, 21 February 1973.

</p>
<p>
   Braden, Bob, &quot;FTP Data Compression&quot;, RFC 468 (NIC 14742), UCLA/CCN,
   8 March 1973.

</p>
<p>
   Bhushan, Abhay, &quot;FTP and Network Mail System&quot;, RFC 475 (NIC 14919),
   MIT-DMCG, 6 March 1973.

</p>
<p>
   Bressler, Bob, and Bob Thomas &quot;FTP Server-Server Interaction - II&quot;,
   RFC 478 (NIC 14947), BBN-NET and BBN-TENEX, 26 March 1973.

</p>
<p>
   White, Jim, &quot;Use of FTP by the NIC Journal&quot;, RFC 479 (NIC 14948),
   SRI-ARC, 8 March 1973.

</p>
<p>
   White, Jim, &quot;Host-Dependent FTP Parameters&quot;, RFC 480 (NIC 14949),
   SRI-ARC, 8 March 1973.

</p>
<p>
   Padlipsky, Mike, &quot;An FTP Command-Naming Problem&quot;, RFC 506
   (NIC 16157), MIT-Multics, 26 June 1973.

</p>
<p>
   Day, John, &quot;Memo to FTP Group (Proposal for File Access Protocol)&quot;,
   RFC 520 (NIC 16819), Illinois, 25 June 1973.

</p>
<p>
   Merryman, Robert, &quot;The UCSD-CC Server-FTP Facility&quot;, RFC 532
   (NIC 17451), UCSD-CC, 22 June 1973.

</p>
<p>
   Braden, Bob, &quot;TENEX FTP Problem&quot;, RFC 571 (NIC 18974), UCLA/CCN,
   15 November 1973.

</p>
<p>
   McKenzie, Alex, and Jon Postel, &quot;Telnet and FTP Implementation -
   Schedule Change&quot;, RFC 593 (NIC 20615), BBN and MITRE,
   29 November 1973.

</p>
<p>
   Sussman, Julie, &quot;FTP Error Code Usage for More Reliable Mail
   Service&quot;, RFC 630 (NIC 30237), BBN, 10 April 1974.

</p>
<p>
   Postel, Jon, &quot;Revised FTP Reply Codes&quot;, RFC 640 (NIC 30843),
   UCLA/NMC, 5 June 1974.

</p>
<p>
   Harvey, Brian, &quot;Leaving Well Enough Alone&quot;, RFC 686 (NIC 32481),
   SU-AI, 10 May 1975.

</p>
<p>
   Harvey, Brian, &quot;One More Try on the FTP&quot;, RFC 691 (NIC 32700), SU-AI,
   28 May 1975.

</p>
<p>
   Lieb, J., &quot;CWD Command of FTP&quot;, RFC 697 (NIC 32963), 14 July 1975.

</p>
<p>
   Harrenstien, Ken, &quot;FTP Extension: XSEN&quot;, RFC 737 (NIC 42217), SRI-KL,
   31 October 1977.

</p>
<p>
   Harrenstien, Ken, &quot;FTP Extension: XRSQ/XRCP&quot;, RFC 743 (NIC 42758),
   SRI-KL, 30 December 1977.

</p>
<p>
   Lebling, P. David, &quot;Survey of FTP Mail and MLFL&quot;, RFC 751, MIT,
   10 December 1978.

</p>
<p>
   Postel, Jon, &quot;File Transfer Protocol Specification&quot;, RFC 765, ISI,
   June 1980.

</p>
<p>
   Mankins, David, Dan Franklin, and Buzz Owen, &quot;Directory Oriented FTP
   Commands&quot;, RFC 775, BBN, December 1980.

</p>
<p>
   Padlipsky, Michael, &quot;FTP Unique-Named Store Command&quot;, RFC 949, MITRE,
   July 1985.

</p>
<p>
RFC 959 "File Transfer Protocol"

</p>
<p>
RFC 1123 "Requirements for Internet Hosts -- Application and Support"

</p>
<p>
RFC 1415 "FTP-FTAM Gateway Specification"

</p>
<p>
RFC 1545 "FTP Operation Over Big Address Records (FOOBAR)"

</p>
<p>
RFC 1579 "Firewall-Friendly FTP"

</p>
<p>
RFC 1635 "How to Use Anonymous FTP"

</p>
<p>
RFC 1639 "FTP Operation Over Big Address Records (FOOBAR)"

</p>
<p>
RFC 2228 "FTP Security Extensions"

</p>
<p>
RFC 2389 "Feature negotiation mechanism for the File Transfer Protocol"

</p>
<p>
RFC 2428 "FTP Extensions for IPv6 and NATs"

</p>
<p>
RFC 2577 "FTP Security Considerations"

</p>
<p>
RFC 2585 "Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP"

</p>
<p>
RFC 2640 "Internationalization of the File Transfer Protocol"

</p>
<p>
RFC 2773 "Encryption using KEA and SKIPJACK"

</p>
<p>
RFC 3659 "Extensions to FTP"

</p>
<p>
RFC 4217 "Securing FTP with TLS"

</p>
<p>
RFC 4823 "FTP Transport for Secure Peer-to-Peer Business Data Interchange over the Internet"

</p>
<p>
RFC 5797 "FTP Command and Extension Registry"

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Acknowledgements and Contributors</h3>

<p>This document is a compendium of various FTP RFCs and their errata, and most are quoted directly. Where differences exist, they are to update the text to current references and make the text coherent as a whole.
</p>
<a name="Appendix-D"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.E"></a><h3>Appendix E.&nbsp;
Changelog from RFC 959 and TODO</h3>

<p>Changelog from RFC 959.
</p>
<blockquote class="text">
<p>Incorporate <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> Errata.
</p>
<p>Incorporate <a class='info' href='#RFC2389'>[RFC2389]<span> (</span><span class='info'>Hethmon, P. and R. Elz, &ldquo;Feature negotiation mechanism for the File Transfer Protocol,&rdquo; August&nbsp;1998.</span><span>)</span></a> FEAT at <a class='info' href='#sec-4.1.4'>Section&nbsp;4.1.4<span> (</span><span class='info'>Feature Negotiation Mechanism</span><span>)</span></a>.
</p>
<p>Incorporate <a class='info' href='#RFC2428'>[RFC2428]<span> (</span><span class='info'>Allman, M., Ostermann, S., and C. Metz, &ldquo;FTP Extensions for IPv6 and NATs,&rdquo; September&nbsp;1998.</span><span>)</span></a> "FTP Extensions for IPv6 and NATs" at <a class='info' href='#sec-4.1.2.1'>Section&nbsp;4.1.2.1<span> (</span><span class='info'>Extensions for IPv6 and NATs: Extended Port (EPRT) and Extended Passive Mode (EPSV)</span><span>)</span></a>.
</p>
<p>Incorporate <a class='info' href='#RFC2577'>[RFC2577]<span> (</span><span class='info'>Allman, M. and S. Ostermann, &ldquo;FTP Security Considerations,&rdquo; May&nbsp;1999.</span><span>)</span></a> in <a class='info' href='#sec-10'>Section&nbsp;10<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
</p>
<p>Include abstract of <a class='info' href='#RFC4217'>[RFC4217]<span> (</span><span class='info'>Ford-Hutchinson, P., &ldquo;Securing FTP with TLS,&rdquo; October&nbsp;2005.</span><span>)</span></a> in <a class='info' href='#sec-10.2'>Section&nbsp;10.2<span> (</span><span class='info'>Securing FTP with TLS</span><span>)</span></a>.
</p>
<p>BCP 14 wording.
</p>
</blockquote><p>

</p>
<p>TODO
</p>
<blockquote class="text">
<p>Determine if changes in RFC 1123 should be applied.
</p>
<p>Triage and include or reference other FTP RFCs - RFC 2228, 2640, 2773?, 3659, 4217.
</p>
<p>Update BNF to ABNF.
</p>
<p>Standardize command organization (subsections?) like EPRT/EPSV, with separated ABNF?
</p>
<p>Move the whole sentence that is <a class='info' href='#sec-8'>Section&nbsp;8<span> (</span><span class='info'>Connection Establishment</span><span>)</span></a> into <a class='info' href='#sec-3.2'>Section&nbsp;3.2<span> (</span><span class='info'>Establishing Data Connections</span><span>)</span></a>?
</p>
<p>Use old IPR value?
</p>
<p>Author listing/credits in compound document done correctly?
</p>
</blockquote><p>

</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jon Postel</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ISI</td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joyce Reynolds</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ISI</td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Paul Hethmon</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hethmon Brothers</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2305 Chukar Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Knoxville</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">TN 37923</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 423 690 8990</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:phethmon@hethmon.com">phethmon@hethmon.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Robert Elz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Melbourne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Parkville</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vic   3052</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kre@munnari.OZ.AU">kre@munnari.OZ.AU</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mark Allman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NASA Lewis Research Center/Sterling Software</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">21000 Brookpark Rd.  MS 54-2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cleveland</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">OH  44135</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(216) 433-6586</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mallman@lerc.nasa.gov">mallman@lerc.nasa.gov</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://gigahertz.lerc.nasa.gov/~mallman/">http://gigahertz.lerc.nasa.gov/~mallman/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shawn Ostermann</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ohio University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">School of Electrical Engineering &amp; Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">416 Morton Hall</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Athens</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">OH  45701</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(740) 593-1234</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ostermann@cs.ohiou.edu">ostermann@cs.ohiou.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Craig Metz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">The Inner Net</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Box 10314-1954</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Blacksburg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">VA  24062-0314</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(DSN) 754-8590</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cmetz@inner.net">cmetz@inner.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Anthony Bryan (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pompano Beach, FL</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:anthonybryan@gmail.com">anthonybryan@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.metalinker.org">http://www.metalinker.org</a></td></tr>
</table>
</body></html>
