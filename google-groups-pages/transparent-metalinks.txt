<h1>transparent-metalinks</h1>
<p>Transparent Metalinks are when people get the benefit of using Metalinks without knowing they are using them via transparent content negotiation [<a href="http://tools.ietf.org/html/rfc2295">RFC2295</a>].</p><p>People using regular download clients (without Metalink support) will get regular files when they request them. People with Metalink clients can request a regular file, but will receive a .metalink describing that file with all the usual things it would contain (mirror lists, checksums, signatures, etc). These have been mentioned in Peter Poeml's <a href="metalink-discussionapachecon08-mirrors.pdf">presentation slides</a> and discussed on the list <a href="http://groups.google.com/group/metalink-discussion/browse_thread/thread/b59e5d99cf879529">here</a>.<br></p><p><br></p><p>The Metalink generator&nbsp;<a href="http://www.mirrorbrain.org/">MirrorBrain</a>&nbsp;supports serving Metalinks through transparent negotiation.</p><p><br></p><p>Currently, aria2 0.13.2, DownThemAll! 1.1 alpha, Retriever 1.1, and Metalink Checker support transparent Metalinks.</p><p><br></p><p>Peter Poeml has added some test cases:</p><p><br></p><p>I have set up a server with testcases for testing the transparent <br> negotionation of metalinks in the way we discussed: <br> </p><p>&nbsp;</p><p><a rel="nofollow" href="http://www.poeml.de/transmetalink-test/">http://www.poeml.de/transmetalink-test/</a> <br> </p><p>&nbsp;</p><pre>Assumptions about the client implementation<br><br>* The metalink client sends "application/metalink4+xml" in the<br>  Accept request header. Note: "*/*" must also be present. <br>  (This is to ensure compliance with RFC 2616, Hayden found at least one<br>  webserver (IIS) that sends an error message if the "*/*" is omitted.)<br><br>* The client checks the returned content type, and if it is<br>  application/metalink4+xml it will handle the metalink<br>  If it is something else, it handles the response as normal response<br>  (downloading the file)<br><br>* The client does _not_ add the application/metalink4+xml to Accept when requesting<br>  a file _from_ a metalink &lt;url&gt; (thus avoiding loops)<br><br>* The client handles external redirects that might send it to the metalink<br></pre><p>Basically, click on the few files and see if what happens is the expected <br> result :-)&nbsp;</p><p><br> </p><p>The README explains the test cases.&nbsp;</p><p><br> </p><p>I hope I got them set up correctly; let me know if not, or if you feel <br> something's missing.&nbsp;</p><p><br> </p>I hope this helps client authors to verify the implementation! <p></p><wbr>